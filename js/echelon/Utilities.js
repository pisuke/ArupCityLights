elon.FmtPointStatus=function(a){var b="NUL";if((a!="")&&(a!=null)&&(a!=undefined)){b=a.substr(3)}if(b=="NO_CONDITION"){b="ONLINE"}return b};elon.util.evt={addEvent:function(f,d,b,a){var e=elon.dom.getDefaultView(f.ownerDocument||f.document||f);if(e.Echelon){if(!e.Echelon.toBeCleanedUp){e.Echelon.toBeCleanedUp={events:[]};elon.UtilObject.getInstance().addEvent(e,"unload",elon.UtilObject.getInstance().m_CleanUpDomMemoryLeaks(e))}if(!e.Echelon.toBeCleanedUp.events){e.Echelon.toBeCleanedUp.events=[]}e.Echelon.toBeCleanedUp.events.push({obj:f,type:d,callback:b,useCapture:a})}if(f.addEventListener){f.addEventListener(d,b,a);return true}else{if(f.attachEvent){var c=f.attachEvent("on"+d,b);return c}}},removeEvent:function(e,d,b,a){if(e.removeEventListener){e.removeEventListener(d,b,a);return true}else{if(e.detachEvent){var c=e.detachEvent("on"+d,b);return c}}},catchEvent:function(a){a=(a)?a:window.event;a.cancelBubble=true;if(a.returnValue){a.returnValue=false}if(a.preventDefault){a.preventDefault()}if(a.stopPropagation){a.stopPropagation()}return false},catchSelectEvent:function(b){try{elon.util.evt.addEvent(b,"selectstart",elon.util.evt.m_handler,false)}catch(a){elon.util.evt.addEvent(b,"select",elon.util.evt.m_handler,false)}},sourceObj:function(a){if(a!=null){if(a.target){return a.target}else{if(a.currentTarget){return a.currentTarget}else{return a.srcElement}}}else{return null}},m_handler:function(a){var b=elon.util.evt.sourceObj(a);if(b.nodeName!="INPUT"){return elon.util.evt.catchEvent(a)}}};elon.util.lon={createRandomDomainKey:function(b,c){var d="";while(d.length<(b*2)||(c!=null&&c!=""&&d==c)){var a=Math.pow(2,8*b);d=Math.round(Math.random()*a).toString(16)}return d},createRandomHex:function(b,a){var d="";if(!b){return d}while(d==""||d==a){for(var c=0;c<b*2;c++){d+=Math.round(Math.random()*15).toString(16)}}return d}};elon.util.assert={isNull:function(a){return((typeof(a)=="object")&&(a==null))},isUndf:function(a){return((typeof(a)=="undefined")&&(a==null))},isSafe:function(a){return(a!=null)},safeCall:function(e,d){d=d.replace(/\[|\]/g,".").replace(/\(([^\)]*)\)/g,".;$1.").replace(/\.\./g,".").replace(/\.$/,"").split(".");var a=e;for(var c=0;c<d.length;c++){var b=(d[c].indexOf(";")!=-1)?a.call(a):a[d[c]];if(b==null){return null}else{a=b}}return a},isArray:function(a){return((typeof(a)=="object")&&(a.constructor==Array))},isFunction:function(a){return(typeof(a)=="function")},isSafePath:function(e,d){var c=false;if(e!=null){d=d.replace("[",".").replace("]",".");var a=d.split(".");for(var b=0;b<a.length;b++){if(e[a[b]]==null){c=false;break}else{c=true;e=e[a[b]]}}}return c},isDiscrete:function(a){if(a){return{BT_SIGNED_CHAR:true,BT_UNSIGNED_CHAR:true,BT_UNKNOWN:true,BT_ENUM:true,BT_BITFIELD:true,BT_ARRAY:true,BT_STRUCT:true,BT_UNION:true}[a]||false}},isScalar:function(b){if(b){for(var a in {DOUBLE:0,FLOAT:0,QUAD:0,LONG:0,SHORT:0}){if(b.search(a)!=-1){return true}}return false}},hasProps:function(b){for(var a in b){if(!elon.browser.IE&&(a=="prototype")){continue}return true}return false}};elon.util.dp={fmtPointStatus:function(a){var b="NUL";if((a!="")&&(a!=null)&&(a!=undefined)){b=a.substr(3)}if(b=="NO_CONDITION"){b="ONLINE"}return b},getUCPTvalue:function(d,a,c){var b=elon.util.dp.getUCPTvalueObj(d,a,c!=null?c:true);return b?b.get():null},getUnitViaDpData:function(d,a,c){var b=elon.util.dp.getUCPTvalueObj(d,a,c?c:true);return b?b.Unit.get():null},getUnitViaDpCfg:function(c){var b="";if(c.UCPTunit){for(var a=0;a<c.UCPTunit.length;a++){if(b!=""){b+=" / "}b+=c.UCPTunit[a].get()}}return b},getUCPTvalueObj:function(e,a,d){if(e!=null&&e.UCPTvalue!=null&&e.UCPTvalue.length>0){var c=null;for(var b=0;b<e.UCPTvalue.length;b++){c=e.UCPTvalue[b];if(a==null||((c.LonFormat.get().replace(/#8000010128000000\[4\]\./,""))==(a.replace(/#8000010128000000\[4\]\./,"")))){return c}}if(d){return e.UCPTvalue[0]}}},pollDp:function(a){elon.PollCollector().poll(a)},createFieldOptions:function(k,a,d){if(k&&k.Item&&k.Item.length){if(a==null){a=true}if(!d){d=new Object()}for(var g=0;g<k.Item.length;g++){var l=k.Item[g];var f=l.UCPTvalue[0].LonFormat.get();var h=elon.util.dp.ensureLonFormatPrefix(f);var b=elon.util.dp.beautifyLonFormat(h);var c=false;if(l.UCPTvalue.length>1){c=new Object();if(a){c[b]=""}else{c["*"]=""}for(var e=1;e<l.UCPTvalue.length;e++){var n=elon.util.dp.beautifyLonFormat(l.UCPTvalue[e].LonFormat.get());var m=l.UCPTvalue[e].LonFormat.get();if(!a){m=n=n.replace(new RegExp("[^.]*."),"")}c[n]=m}}d[h]=c}}return d},ensureLonFormatPrefix:function(a){var b=a.slice(0,1);if(b=="#"){return a}if(b=="S"){return("#0000000000000000[0]."+a)}return("#8000010128000000[4]."+a)},delocalizeLonFormat:function(c){c=elon.util.dp.ensureLonFormatPrefix(c);var b=c.split("#");if(b.length>2){c="#"+b[1]}return c},identicalDelocalizedLonFormats:function(d,c){return(elon.util.dp.delocalizeLonFormat(d)==elon.util.dp.delocalizeLonFormat(c))},getNvtMember:function(f,b){b=elon.util.dp.ensureLonFormatPrefix(b);var e=b.split(".");for(var c=2;c<e.length;c++){f=(f.struct_&&f.struct_.r_proxy_type)?f.struct_:f.union_;if(!f.Member){return}var d=e[c];for(var a=0;a<f.Member.length;a++){if(f.Member[a].UCPTmemberName.get().split("[")[0]==d.split("[")[0]){f=f.Member[a];break}}}return f},beautifyLonFormat:function(a){return a?a.replace(new RegExp("#[^.]*."),""):a}};elon.util.serial={findSerialPortConflicts:function(c,b){if(c&&b){elon.util.serial.serialPortTestObj={callback:c};b.Get({xSelect:"//Item[@xsi:type='MBS_Channel_Cfg']",callback:elon.util.serial.m_Handle("MBS"),noErrMsg:true,includeLocal:true});b.Get({xSelect:"//Item[@xsi:type='MOD_Channel_Cfg']",callback:elon.util.serial.m_Handle("MOD"),noErrMsg:true,includeLocal:true});var a=elon.ConnectionManagerObject.getInstance(b.getUrl());a.fetchCm(elon.util.serial.m_Handle("CM"))}},m_Handle:elon.Class({constructor:["m_type"],closure:function(b,a){if(b){elon.util.serial.serialPortTestObj[this.m_type]=b;elon.util.serial.m_eval()}}}),m_eval:function(a){if(elon.util.serial.serialPortTestObj.CM&&elon.util.serial.serialPortTestObj.MOD&&elon.util.serial.serialPortTestObj.MBS){var k=null;var m=/\=(\d*)\]/;var c=elon.util.serial.serialPortTestObj.CM.GlobalPPP.UCPTdefaultModem.match(m);if(c!=null){k=c[1]}var j;for(var h=0;h<elon.util.serial.serialPortTestObj.CM.Modem.length;h++){if(elon.util.serial.serialPortTestObj.CM.Modem[h].UCPTindex==k){j=elon.util.serial.serialPortTestObj.CM.Modem[h]}}var b=false;if(j&&((j.UCPTmodemType=="MT_GSM_EXT")||(j.UCPTmodemType=="MT_ANALOG_EXT"))){b=true}var d=0;var g=elon.util.serial.serialPortTestObj.MBS;d=d&&d.Item.length&&(d.Item[0].UCPTchannelType.get()=="CT_RS232_MASTER");if(g){for(var h=0;h<g.Item.length;h++){if(g.Item[h].UCPTchannelType.get()=="CT_RS232_MASTER"){d++}}}var f=0;g=elon.util.serial.serialPortTestObj.MOD;if(g){for(var h=0;h<g.Item.length;h++){if(g.Item[h].UCPTchannelType.get()=="CT_RS232_MASTER"){f++}}}var e=elon.ErrorTable.getInstance();var l=null;if(b&&d){l=e.ERR_COMMON_SERIAL_CONFLICT_MBUS}else{if(b&&f){l=e.ERR_COMMON_SERIAL_CONFLICT_MODBUS}else{if(d&&f){l=e.ERR_COMMON_SERIAL_CONFLICT_DRIVERS}}}if(l){l=elon.Error.getInstance(l)}elon.util.serial.serialPortTestObj.callback(l)}}};elon.util.dom={m_CleanUpDomMemoryLeaks:elon.Class({constructor:["m_win"],closure:function(a){var c=this.m_win.Echelon.toBeCleanedUp.events;if(c){if(c[0].obj.removeEventListener){for(var b=0;b<c.length;b++){c[b].obj.removeEventListener(c[b].type,c[b].callback,c[b].useCapture)}}else{if(c[0].obj.detachEvent){for(var b=0;b<c.length;b++){c[b].obj.detachEvent("on"+c[b].type,c[b].callback)}}}}var c=this.m_win.Echelon.toBeCleanedUp.expandos;if(c){for(var b=0;b<c.length;b++){c[b].obj[c[b].key]=null}}delete this.m_win.Echelon.toBeCleanedUp;this.m_win.Echelon=null;delete this.m_win}}),addExpando:function(d,a,b){var c=elon.dom.getDefaultView(d.ownerDocument||d.document||d);if(!c.Echelon.toBeCleanedUp){c.Echelon.toBeCleanedUp={expandos:[]};elon.UtilObject.getInstance().addEvent(c,"unload",elon.UtilObject.getInstance().m_CleanUpDomMemoryLeaks(c))}if(!c.Echelon.toBeCleanedUp.expandos){c.Echelon.toBeCleanedUp.expandos=[]}c.Echelon.toBeCleanedUp.expandos.push({obj:d,key:a});d[a]=b},getExpando:function(b,a){return b[a]},addClassName:function(b,a){if(!b){return}elon.util.dom.rmClassName(b,a);if(a.className){a.className+=" "+b}else{a.className=b}},rmClassName:function(f,d){if(f==null||f==""){return}var a=(d.className||"").split(" ");if(typeof(f)=="string"){var c=f.split(" ");for(var b=0;b<c.length;b++){for(var e=0;e<a.length;e++){if(a[e]==c[b]){a.splice(e,1)}}}}else{for(var e=0;e<a.length;e++){if(a[e].match(f)){a.splice(e,1)}}}d.className=a.join(" ")},replaceClassName:function(c,a,b){elon.util.rmClassName(c,b);elon.util.addClassName(a,b)},hasClassName:function(b,a){return(a.className||"").match(new RegExp("(^|\\s)"+elon.util.escapeRegExp(b)+"($|\\s)"))?true:false},setClassName:function(c,b,a){elon.util[(c?"add":"rm")+"ClassName"](b,a)},getParent:function(b,a){if(!elon.util.assert.isSafe(b)){return null}if(b.nodeType==1&&b.tagName.toLowerCase()==a.toLowerCase()){return b}else{return elon.util.dom.getParent(b.parentNode,a)}},write:function(d,a,c){var b=d.ownerDocument.createElement("span");b.appendChild(d.ownerDocument.createTextNode(a));b.className=c;d.appendChild(b)},disableField:function(a,b){b.style.backgroundColor=(a)?"lightgrey":"white";b.disabled=a},disableInterface:function(a,b){for(var c=0;c<b.elements.length;c++){if((b.elements[c].className!="ErrorText")&&(b.elements[c].className!="InfoText")){if((b.elements[c].type=="text")||(b.elements[c].type=="select-one")||(b.elements[c].type=="select-multiple")||(b.elements[c].type=="password")||(b.elements[c].type=="textarea")){elon.util.dom.disableField(a,b.elements[c])}else{b.elements[c].disabled=a}}}},FixTableColor:function(b){for(var a=0;a<b.rows.length;a++){if((a==0)||((a%2)==0)){b.rows[a].className="color"}else{b.rows[a].className="nocolor"}}},resizeImage:function(c,b,d,a){if(b){elon.util.callback.fireQuickCallback(elon.util.dom.m_resImg,this,{img:c,height:b,cb:a})}else{if(d){elon.util.callback.fireQuickCallback(elon.util.dom.m_resImg,this,{img:c,width:d,cb:a})}}},m_resImg:function(a){try{if(a.style.height){a.img.style.width=elon.util.addPx(Math.round(a.style.height*parseInt(a.img.currentStyle.style.width,10)/parseInt(a.img.currentStyle.style.height,10)));a.img.style.height=elon.util.addPx(a.style.height)}else{if(a.style.width){a.img.style.height=elon.util.addPx(Math.round(a.style.width*parseInt(a.img.currentStyle.style.height,10)/parseInt(a.img.currentStyle.style.width,10)));a.img.style.width=elon.util.addPx(a.style.width)}}if(a.cb){a.cb()}}catch(b){}},pxToNum:function(a){return parseInt(((a||"").match(/-?\d*/)[0]||"0"),10)},addPx:function(a){return(a&&!(a.match&&a.match(/px$/)))?(a+"px"):a},isAlive:function(b,a){try{if(b==true){return true}var f=b.ownerDocument;var c=f.m_elonAlive;if(c==null){c=false;try{if(elon.dom.getDefaultView(b).document==b.ownerDocument){b.getAttribute("foo");c=true}}catch(d){}try{f.m_elonAlive=c;elon.util.fireQuickCallback(function(g){try{if(elon.browser.IE){g.m_elonAlive=null}else{delete g.m_elonAlive}}catch(h){}},null,f)}catch(d){elon.elon.setErrMsg("Internal GC error")}}if(c){c=false;try{while(b){if(b==f.documentElement){c=(elon.dom.getTopWindow(elon.dom.getDefaultView(b))==elon.window);break}b=b.parentNode}}catch(d){}}return c}catch(d){return false}},SetTitle:elon.Class({constructor:function(b){if(!elon.util.SetTitle.m_originalTitle){elon.util.SetTitle.m_originalTitle=elon.window.document.title}try{elon.window.document.title=b}catch(a){}},closure:function(){try{elon.window.document.title=elon.util.SetTitle.m_originalTitle}catch(a){}delete elon.util.SetTitle.m_originalTitle}})};elon.util.transcode={escapeRegExp:function(b){if(!arguments.callee.m_sRE){var a=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.m_sRE=new RegExp("(\\"+a.join("|\\")+")","g")}return b.replace(arguments.callee.m_sRE,"\\$1")},escapedRegExp:function(a){return new RegExp(elon.util.escapeRegExp(a))},base64Chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),encodeBase64:function(e){var d=e.length%3;while(e.length%3){e+="\0"}var f=e.match(/(.{3})/g).slice(0);var a="";for(var c=0;c<f.length;c++){if(c&&!((c*4)%76)){a+="\r\n"}var b=(f[c].charCodeAt(0)<<16)+(f[c].charCodeAt(1)<<8)+f[c].charCodeAt(2);b=[(b>>>18)&63,(b>>>12)&63,(b>>>6)&63,b&63];a+=[elon.util.transcode.base64Chars[b[0]],elon.util.transcode.base64Chars[b[1]],elon.util.transcode.base64Chars[b[2]],elon.util.transcode.base64Chars[b[3]]].join("")}if(d){a=a.substr(0,a.length-3+d)+"==".substr(0,3-d)}return a},template:function(d,g){var b=d;var c=/^([^\$]*)\$([^;]*);(.*)$/;var a=new Array();var f=new Array();do{a=c.exec(d);if(a!=null){f.push(a[2]);d=a[3]}}while(a!=null);for(var e=0;e<f.length;e++){b=b.replace("$"+f[e]+";",g[f[e]])}return b},substitutePlaceholders:function(h,d){var a=h.match(/{[^}]*/g);if(a!=null&&a.length>0){for(var c=0;c<a.length;c++){var b=a[c].slice(1);var f=b.match(new RegExp("^([A-Za-z_][A-Za-z_0-9]*)(s*=s*(.*))?$"));var e=null;if(f&&f.length){var g=f[1];e=f.length>3?f[3]:null;if(d[g]!=null){e=d[g]}}if(e){h=h.replace(new RegExp("{"+b+"}","g"),e)}}}return h},m_placeholderExp:new RegExp("^elon_placeholder_(\\w+)"),substituteArgObjPlaceholders:function(f,a){var b={};var e=false;var d;for(var c in f){d=c.match(this.m_placeholderExp);if(d){e=true;b[d[1]]=f[c]}}return e?elon.util.substitutePlaceholders(a,b):a},beautifyFailureMask:function(h,e,o,m){var n=h.split(",");var k=o.clone();var g=o.clone();g.addMinutes(m);var j="";var a=true;for(var c=0;c<n.length;c++){if(Number(n[c])){var l=g.toFormattedString("%2h:%2m");var b=k.toFormattedString("%2h:%2m");var d=(m>0?b:l)+"&nbsp;-&nbsp;"+(m>0?l:b);j+=e("FAILURE")+": "+d+"<br>"}else{a=false}k.addMinutes(m);g.addMinutes(m)}if(!j){j=e("NO_FAILURE")}if(a){e("PERMANENT_FAILURE")}return j},convertDegreeObject2Float:function(c){var a=0;if(elon.util.assert.isSafe(c)){if(elon.util.assert.isSafe(c.degrees)){var b=(c.degrees>=0)?1:-1;a=parseFloat(c.degrees);if(isNaN(a)){return 0}if(elon.util.assert.isSafe(c.minutes)){if(!isNaN(parseFloat(c.minutes))){a+=b*(Math.abs(parseFloat(c.minutes))/60)}}if(elon.util.assert.isSafe(c.seconds)){if(!isNaN(parseFloat(c.seconds))){a+=b*(Math.abs(parseFloat(c.seconds))/3600)}}}}return a},convertDegreeFloat2Object:function(a){var b={degrees:0,minutes:0,seconds:0};if(elon.util.assert.isSafe(a)){var c=parseFloat(a);if(!isNaN(c)){b.degrees=(c>=0)?Math.floor(c):Math.ceil(c);c=Math.abs(c-b.degrees);b.minutes=Math.floor(c*60);c=Math.abs(c-(b.minutes/60));b.seconds=Math.round(c*3600);if(b.seconds>=60){b.minutes++;b.seconds=0;if(b.minutes>=60){b.degrees++}}}}return b},convertSecTodhms:function(d,b){var e=elon.TimeObject.getInstance(d*1000).toFormattedString(Math.floor(d/86400)+b.translate("ABB_DAY")+" %h"+b.translate("ABB_HOUR")+" %m"+b.translate("ABB_MIN")+" %s"+b.translate("ABB_SEC")).split(" ");var a="";for(var c=0;c<e.length;c++){if(e[c].charAt(0)!="0"){a+=e[c]}}return a||("0"+b.translate("ABB_SEC"))},addLeadingZeros:function(i,h,g){g=(elon.util.assert.isSafe(g))?g:10;var c=parseInt(i,10);if(c<0){var d=true;c*=-1;var a="-"}else{var a=""}var b=c.toString(g).length;for(var e=0;e<(h-b);e++){a+="0"}a+=c.toString(g);return a},toFloatingPoint:function(c,a){if(!elon.util.assert.isSafe(c)){return""}else{if(typeof c=="number"){if(elon.util.assert.isSafe(a)){c.toFixed(a)}c=c.toString()}if(c!=""){if(c.indexOf(".")==-1){c+=".0"}if((elon.util.assert.isSafe(a))&&(a>1)){for(var b=0;b<a;b++){c+="0"}}}return c}},xpath2obj:function(g){var i=/([\/\.\w]+\[(?:\w+\=\d+\|?)+\])/g;var m=/^([\/\.\w]+)(\[(?:\w+\=\d+\|?)+\])$/;var o=/([\.\w]+|\/\/)/g;var b=/(\w+\=[\w\d]+)/g;var f={pathArr:new Array(),objKeyArr:new Array()};if((elon.util.assert.isSafe(g))&&(typeof(g)=="string")){var h=g.match(i);if((elon.util.assert.isSafe(h))&&(h.length>0)){var n=h[0].match(m);if(elon.util.assert.isSafe(n)){var l=n[1].match(o);if(elon.util.assert.isSafe(l)){for(var c=0;c<l.length;c++){f.pathArr[f.pathArr.length]=l[c]}}}var q=n[2].match(b);if(elon.util.assert.isSafe(q)){for(var e=0;e<q.length;e++){var d=q[e].split("=");f.objKeyArr[f.objKeyArr.length]={keyName:d[0],keyVal:d[1]}}}if(h.length>1){var a="";for(var j=1;j<h.length;j++){a+=h[j]}f.xpathObj=elon.util.transcode.xpath2obj(a)}}}return f},obj2xpath:function(b){var c="";if((elon.util.assert.isSafe(b))&&(typeof(b)=="object")){if(elon.util.assert.isSafe(b.pathArr)){for(var d=0;d<b.pathArr.length;d++){if(elon.util.assert.isSafe(b.pathArr[d])){if(b.pathArr[d]=="//"){c+="//"}else{if(d==b.pathArr.length-1){c+=b.pathArr[d]}else{c+=b.pathArr[d]+"/"}}}}}if(elon.util.assert.isSafe(b.objKeyArr)){c+="[";for(var a=0;a<b.objKeyArr.length;a++){if(elon.util.assert.isSafe(b.objKeyArr[a])){if(a==b.objKeyArr.length-1){c+=b.objKeyArr[a].keyName+"="+b.objKeyArr[a].keyVal}else{c+=b.objKeyArr[a].keyName+"="+b.objKeyArr[a].keyVal+"|"}}}c+="]"}if(elon.util.assert.isSafe(b.xpathObj)){c+="/"+elon.util.transcode.obj2xpath(b.xpathObj)}}return c},versionStr2Obj:function(c){var b={majorVersion:-1,minorVersion:-1,buildNumber:-1};if((elon.util.assert.isSafe(c))&&(typeof(c)=="string")){var a=c.split(".");if((a.length>0)&&(!isNaN(parseInt(a[0],10)))){b.majorVersion=parseInt(a[0],10)}if((a.length>1)&&(!isNaN(parseInt(a[1],10)))){b.minorVersion=parseInt(a[1],10)}if((a.length>2)&&(!isNaN(parseInt(a[2],10)))){b.buildNumber=parseInt(a[2],10)}}return b},removeLocalHost:function(a,b){return b?a.replace(new RegExp("^"+elon.util.escapeRegExp(b)+":"),""):a},relativeName:function(d,f,b){var g=new RegExp("^"+elon.util.escapeRegExp(f)+"/");if(d.match(g)){return d.replace(g,"./")}var a=f.split("/");var e="../";for(var c=0;c<(b||2);c++){a.pop();g=new RegExp("^"+elon.util.escapeRegExp(a.join("/"))+"/");if(d.match(g)){return d.replace(g,e)}e=e+"../"}return d}};elon.util.arrObj={CopyArr:function(b){var d=new Array();for(var c in b){if((typeof(b[c])=="object")&&(b[c]==null)){d[c]=null}else{if(typeof(b[c])=="object"){d[c]=elon.util.arrObj.CopyArr(b[c])}else{if(typeof(b[c])!="function"){d[c]=b[c]}}}}return d},CopyCompleteArr:function(b){var d=new Array();for(var c in b){if((typeof(b[c])=="object")&&(b[c]==null)){d[c]=null}else{if(typeof(b[c])=="object"){d[c]=elon.util.arrObj.CopyCompleteArr(b[c])}else{d[c]=b[c]}}}return d},MergeArrs:function(d,c){if(typeof(c)=="undefined"){c=new Array()}for(var b in d){if((typeof(d[b])=="object")&&(d[b]==null)){if(typeof(c[b])!="object"){c[b]=null}}else{if(typeof(d[b])=="object"){if(typeof(c[b])!="object"){c[b]=new Array()}elon.util.arrObj.MergeArrs(d[b],c[b])}else{if(typeof(d[b])!="function"){if(typeof(c)!="object"){c=new Array()}c[b]=d[b]}}}}},RemoveArrDups:function(a,d){if(d==undefined){d=function(f,e){return(f==e)}}if(typeof(a)!="object"){return a}for(var c=a.length-1;c>0;c--){for(var b=c-1;b>-1;b--){if(d(a[c],a[b])){a.splice(c,1);break}}}},copyObject:function(d,c){var a={};for(var b in d){a[b]=(!c&&(typeof(d[b])=="object"))?elon.util.arrObj.copyObject(d[b]):d[b]}if(d&&(d.length!=null)){a.length=d.length}return a},m_arrEachRetArr:function(a,d){var b=elon.util.arrObj.Array();for(var c=0;c<a.length;c++){d(a[c],c,b)}return b},arrCollect:function(a,b){return elon.util.arrObj.m_arrEachRetArr(a,function(e,d,c){c.push(b(e,d))})},arrCollectToObj:function(a,c){var b={};elon.util.arrObj.arrEach(a,function(f,e){var d=c(f,e);b[d.name]=d.value});return b},arrCompact:function(a){return elon.util.arrObj.m_arrEachRetArr(a,function(d,c,b){if(elon.util.assert.isSafe(d)){b.push(d)}})},arrConcat:function(b,a){for(var c=0;c<a.length;c++){b[b.length]=a[c]}return b},arrCopy:function(a){return elon.util.arrObj.arrCollect(a,function(b){return b})},arrEach:function(a,c){for(var b=0;b<a.length;b++){c(a[b],b)}},arrIndex:function(a,c){for(var b=0;b<a.length;b++){if(a[b]==c){return b}}return null},arrJoin:function(a,c){var b=(c!=null)?c:",";var d="";elon.util.arrObj.arrEach(a,function(f,e){d=d+f+((e==(a.length-1))?"":b)});return d},arrSelect:function(a,b){return elon.util.arrObj.m_arrEachRetArr(a,function(e,d,c){if(b(e,d)){c.push(e)}})},arrUniq:function(a){return elon.util.arrObj.m_arrEachRetArr(a,function(d,c,b){if(b.index(d)==null){b.push(d)}})},arrLast:function(a){return(a.length!=0)?a[a.length-1]:null},Array:function(b){var c=(b!=null)?b:new Array();c.a=c;c.collect=function(a){return elon.util.arrObj.arrCollect(c.a,a)};c.collectToObj=function(a){return elon.util.arrObj.arrCollectToObj(c.a,a)};c.compact=function(){return elon.util.arrObj.arrCompact(c.a)};c.concat=function(a){return elon.util.arrObj.arrConcat(c.a,a)};c.copy=function(){return elon.util.arrObj.arrCopy(c.a)};c.each=function(a){return elon.util.arrObj.arrEach(c.a,a)};c.index=function(a){return elon.util.arrObj.arrIndex(c.a,a)};c.join=function(a){return elon.util.arrObj.arrJoin(c.a,a)};c.last=function(){return elon.util.arrObj.arrLast(c.a)};c.push=function(a){c.a[c.a.length]=a;return c.a};c.select=function(a){return elon.util.arrObj.arrSelect(c.a,a)};c.uniq=function(){return elon.util.arrObj.arrUniq(c.a)};c.utilObjArr=true;return c},objEach:function(d,c){var b=0;for(var a in d){c(d[a],a,b);b++}},objCollect:function(c,b){var a={};elon.util.arrObj.objEach(c,function(f,e,d){a[e]=b(f,e,d)});return a},objCollectToArr:function(c,b){var a=[];elon.util.arrObj.objEach(c,function(f,e,d){a[d]=b(f,e,d)});return a},objConcat:function(b,a){elon.util.arrObj.objEach(a,function(d,c){b[c]=d});return b},concat:function(b,a){if(b.utilObjArr&&a.utilObjArr){b.concat(a)}else{if(!b.utilObjArr&&!a.utilObjArr){elon.util.arrObj.objConcat(b,a)}else{throw new Error("Cannot concatenate mixed types in UtilObject.concat")}}return b},arrToUl:function(a,b){return"<ul"+(b?(' style="'+b+'"'):"")+"><li>"+a.join("</li><li>")+"</li></ul>"}};elon.util.soap={getNextUsedIndex:function(b,a){a.sort(function(e,d){var f=e.UCPTindex-d.UCPTindex;if(f<=0){return -1}else{return 1}});for(var c=0;c<a.length;c++){if(a[c].UCPTindex!=b){b=a[c].UCPTindex;break}}return b},getNextFreeIndex:function(c){if(!c||!c.length){return 0}if(c[0].UCPTindex==null){return null}var d=[];if(c[0].UCPTindex.get){for(var b=0;b<c.length;b++){if(!isNaN(parseInt(c[b].UCPTindex.get(),10))){d.push(c[b].UCPTindex.get())}}}else{for(var b=0;b<c.length;b++){if(!isNaN(parseInt(c[b].UCPTindex,10))){d.push(c[b].UCPTindex)}}}d=d.sort(elon.util.soap.m_intSort);var a=d[0]||0;for(var b=0;b<d.length;b++){if(a==d[b]){a++}else{break}}return a},m_intSort:function(d,c){return d-c},getNextFreeNumbers:function(a,h,f){var g=[];var b=new RegExp("^"+elon.util.escapeRegExp(a)+"(\\d*)");for(var d=0;d<h.length;d++){a=typeof(h[d])=="string"?h[d]:h[d].UCPTname.get();var e=a.match(b);if(e){g[e[1]?parseInt(e[1],10):0]=true}}var k=[];for(var d=0;d<(f||1);d++){var c=d;while(g[c]){c++}g[c]=true;k.push(c||"")}return f?k:k[0]},ucptIndexSort:function(d,c){var e=d.UCPTindex.get()-c.UCPTindex.get();if(e<=0){return -1}else{return 1}},auth:function(a,b){if(!elon.auth){elon.auth={}}elon.auth[elon.elon.httpS(a)]=b},url:function(d,c,a,b){return(d?(d+"://"):"")+c+((a==80||a==null||a=="")?"":(":"+a))+b},wcc2url:function(b,d){var e=b.UCPTprotocol.get();var c=b.UCPTdomain.get();var a=b.UCPTport.get();if(d==null){d=b.UCPTsoapPath.get()}return elon.util.url(e,c,a,d)}};elon.util.time={getOptimalTimeInterval:function(b,a){var c=b/a;if(c<10){return c}if(c<100){return Math.round(c/10)*10}if(c<1000){return Math.round(c/100)*100}if(c<5000){return Math.round(c/1000)*1000}if(c<15000){return Math.round(c/5000)*5000}if(c<60000){return Math.round(c/15000)*15000}if(c<300000){return Math.round(c/60000)*60000}if(c<900000){return Math.round(c/300000)*300000}if(c<3600000){return Math.round(c/900000)*900000}if(c<86400000){return Math.round(c/3600000)*3600000}return Math.round(c/86400000)*86400000},getDisplayStringFromMs:function(a,b){if(b<1000){return b+(" millisecond"+((b>1)?"s":""))}else{if(b<60000){return Math.round(b/1000)+(" "+((b>1000)?a.SECONDS:a.SECOND))}else{if(b<3600000){return Math.round(b/60000)+(" "+((b>60000)?a.MINUTES:a.MINUTE))}else{if(b<86400000){return Math.round(b/3600000)+(" "+((b>3600000)?a.HOURS:a.HOUR))}else{if(b<604800000){return Math.round(b/(86400000))+(" "+((b>86400000)?a.DAYS:a.DAY))}else{if(b<2628000000){return Math.round(b/(604800000))+(" "+((b>604800000)?a.WEEKS:a.WEEK))}else{if(b<31536000000){return Math.round(b/(4233600000))+(" "+((b>4233600000)?a.MONTHS:a.MONTH))}else{return Math.round(b/(31536000000))+(" "+((b>31536000000)?a.YEARS:a.YEAR))}}}}}}}}};elon.UtilObject={getInstance:function(){if(elon.UtilObject.instance==null){var c={};for(var b in elon.util){c[b]=elon.util[b]}for(var b in c){for(var a in c[b]){elon.util[a]=c[b][a]}}elon.UtilObject.instance=elon.util}return elon.util},instance:null};elon.UtilObject.getInstance();elon.XmlParser=function(){this.str2Xml=function(a){return a.replace(/&gt;/g,">").replace(/&lt;/g,"<")};this.xml2Str=function(a){return a.replace(/>/g,"&gt;").replace(/</g,"&lt;")};this.dom2Js=function(d){var g={};if(d.nodeValue!=null){g=d.nodeValue}else{if((d.childNodes.length==1)&&(d.firstChild.nodeName=="#text")){g=d.firstChild.nodeValue}else{if(d.childNodes.length!=0){var c=d.firstChild.nodeName;var a=[];for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if((c=="#text")&&((c=f.nodeName)=="#text")){continue}if(c==f.nodeName){a[a.length]=f}else{if(f.nodeName!="#text"){if(a.length>1){g[c]=new Array(a.length);for(var b in a){g[c][b]=this.dom2Js(a[b])}}else{g[c]=this.dom2Js(a[0])}a=[f];c=f.nodeName}}}if((a.length>0)&&(c!="#text")){if(a.length>1){g[c]=new Array(a.length);for(var b in a){g[c][b]=this.dom2Js(a[b])}}else{g[c]=this.dom2Js(a[0])}}}else{g=""}}}if((d.attributes!=null)&&(d.attributes.length>0)){if(typeof(g)!="object"){g={value:g}}for(var e=0;e<d.attributes.length;e++){g[d.attributes[e].nodeName]=this.dom2Js(d.attributes[e])}}return g};this.xml2Dom=elon.browser.IE?function(a){this.m_parser.loadXML(a);return this.m_parser}:function(a){return this.m_parser.parseFromString(a,"text/xml")};this.xml2Js=function(a){return this.dom2Js(this.xml2Dom(a).firstChild)};this.str2Js=function(a){return this.xml2Js(this.str2Xml(a))};this.m_entag=function(b,a){return"<"+a+">"+b+"</"+a+">"};this.js2Xml=function(c){var a=[];for(var b in c){a.push((typeof(c[b])=="object")?this.m_entag(this.js2Xml(c[b]),b):this.m_entag(c[b],b))}return a.join("")};this.js2Str=function(b,a){return this.xml2Str(this.js2Xml(b,a))};this.m_parser=elon.browser.IE?new ActiveXObject("Msxml2.DOMDocument.3.0"):new DOMParser();if(elon.browser.IE){this.m_parser.async=false;this.m_parser.validateOnParse=false;this.m_parser.resolveExternals=false}};elon.XmlParser.getInstance=function(){if(elon.XmlParser.instance==null){elon.XmlParser.instance=new elon.XmlParser()}return elon.XmlParser.instance};elon.ObjectArrayUtilities=function(){this.ensureArray=function(c){if(c.length>0){return c}var b=new Array();if(c.hasOwnProperty("UCPTname")){b.push(c)}return b};this.reduceToKeys=function(e,d,a){e=this.ensureArray(e);var b=new Array();var f=null;for(var c=0;c<e.length;c++){if(e[c]!=""){f=new Object();a(f,d(e[c]));b.push(f)}}return b};this.objArrToKeyList=function(d,c){d=this.ensureArray(d);var a="";for(var b=0;b<d.length;b++){a+=(c(d[b])+elon.ObjectArrayUtilities.separator)}return a.slice(0,0-elon.ObjectArrayUtilities.separator.length)};this.keyListToObjArr=function(e,a){if(e==null||e==""){return new Array()}var c=e.split(elon.ObjectArrayUtilities.separator);var b=new Array();var f=null;for(var d=0;d<c.length;d++){f=new Object();a(f,c[d]);b.push(f)}return b};this.getObjectViaKey=function(d,b,c){if(b!=null&&c!=null){for(var a=0;a<d.length;a++){if(c(d[a])==b){return d[a]}}}return null};this.getObjArrViaFilter=function(e,b,d){var c=new Array();if(b!=null&&d!=null){for(var a=0;a<e.length;a++){if(d(e[a])==b){c.push(e[a])}}}return c};this.insertIntoArray=function(f,e,d){e=this.ensureArray(e);if(e!=null&&d!=null){for(var c=0;c<e.length;c++){var b=d(e[c]);for(var a=0;a<f.length;a++){if(d(f[a])==b){f[a]=e[c];break}}if(a==f.length){f.push(e[c])}}}};this.removeViaObject=function(d,c,b){c=this.ensureArray(c);for(var a=0;a<c.length;a++){this.removeViaKey(d,b(c[a]),b)}};this.removeArray1FromArray2=function(c,b,a){this.removeViaObject(b,c,a)};this.removeArray2FromArray1=function(c,b,a){this.removeViaObject(c,b,a)};this.array2MinusArray1=function(e,d,c,a){var b=this.reduceToKeys(d,c,a);if(e!=null){this.removeViaObject(b,e,c)}return b};this.array1MinusArray2=function(d,c,b,a){return this.array2MinusArray1(c,d,b,a)};this.removeViaKey=function(d,b,c){for(var a=0;a<d.length;a++){if(c(d[a])==b){d.splice(a,1);break}}}};elon.ObjectArrayUtilities.instance=null;elon.ObjectArrayUtilities.getInstance=function(){if(elon.ObjectArrayUtilities.instance==null){elon.ObjectArrayUtilities.instance=new elon.ObjectArrayUtilities()}return elon.ObjectArrayUtilities.instance};elon.ObjectArrayUtilities.separator="#";elon.CacheObject=function(i,e,f,b,a){var c=(i==null)?new Array():i;var j=(e==null)?new Array():e;var d=(f==null)?new Array():f;var h=(b==null)?0:b;var g=(a==null)?600:a;this.clear=function(){c.length=0;j.length=0;d.length=0;h=0};this.getSize=function(){return h};this.getMaxSize=function(){return g};this.setMaxSize=function(l){var n=false;if((!isNaN(l))&&(l>=0)){n=true;if(g>l){for(var k=l-1;k<j.length;k++){if(typeof(j[k])!="undefined"){delete c[j[k]];delete j[k]}}for(var m=d.length-1;m>-1;m--){if(d[m]>=l){d.splice(m,1)}}}g=l}return n};this.addObj=function(l,k){var m=false;if((!isNaN(k))&&(k>=0)){k=k%g;if(j[k]==null){j[k]=(d.length==0)?c.length:d.pop()}if(c[j[k]]==null){h++}c[j[k]]=l;m=true}return m};this.removeObj=function(k){var l=false;if((!isNaN(k))&&(k>=0)){k=k%g;if(typeof(j[k])!="undefined"){d.push(j[k]);delete c[j[k]];delete j[k];l=true;h--}}return l};this.getObj=function(k){var l=null;if((!isNaN(k))&&(k>=0)){k=k%g;if(typeof(j[k])!="undefined"){l=c[j[k]]}}return l};this.getAllObjsAndKeys=function(){var m=new Array();for(var l=0;l<j.length;l++){if(typeof(j[l])!="undefined"){m[m.length]={obj:c[j[l]],key:l}}}return m};this.getAllObj=function(){var m=new Array();for(var l=0;l<j.length;l++){if(typeof(j[l])!="undefined"){m[m.length]=c[j[l]]}}return m};this.getCopy=function(){var m=elon.UtilObject.getInstance().CopyArr(c);var l=elon.UtilObject.getInstance().CopyArr(j);var n=elon.UtilObject.getInstance().CopyArr(d);var k=new elon.CacheObject(m,l,n,h,g);return k}};elon.CacheObject.getInstance=function(){return new elon.CacheObject()};elon.StringHelperObject=function(){this.stripOuterBlanks=function(a){var b=/^\s*\S*\s*$/;if(a.search(b)!=-1){return this.stripBlanks(a)}else{return false}};this.leaveInnerBlanks=function(b){var a=/^\s*(\S.*)/;var d=/(.*\S)\s*$/;var c=b.match(a);if(c!=null){c=c[1].match(d)}if(c!=null){return c[1]}else{return""}};this.stripBlanks=function(c){var a="";for(var b=0;b<c.length;b++){if(c.substr(b,1)!=" "){a+=c.substr(b,1)}}return a};this.stripColons=function(c){var a="";for(var b=0;b<c.length;b++){if(c.substr(b,1)!=":"){a+=c.substr(b,1)}}return a};this.prepareMd5Raw=function(b){var a=b.split(":");if(a.length==16){return b}else{var d=this.stripBlanks(b);var e="";for(var c=0;c<29;c=c+2){e+=d.substring(c,c+2)+":"}e+=d.substring(30);return e}}};elon.StringHelperObject.instance;elon.StringHelperObject.getInstance=function(){if(elon.StringHelperObject.instance==null){elon.StringHelperObject.instance=new elon.StringHelperObject()}return elon.StringHelperObject.instance};elon.ValidationObject=function(){var a=elon.StringHelperObject.getInstance();var b=elon.ErrorTable.getInstance();var d=elon.UtilObject.getInstance();var c=this;this.handleValidation=function(f,e){if(e(f.value)){f.style.backgroundColor="white";return true}else{f.style.backgroundColor="red";return false}};this.validateIpSegment=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces are not permitted in IP address.");return false}else{if((f>=0)&&(f<=255)&&(f!="")){return true}else{alert("Each address segment must be between 0 and 255.");return false}}};this.validatePort=function(f){var e=a.stripOuterBlanks(f);if(e.toString()=="false"){alert("Spaces are not permitted in port number.");return false}else{if(((e>=1)&&(e<=65535))||(e=="")){return true}else{alert("Port number must be between 1 and 65535.");return false}}};this.validateIp=function(h){var i=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;var e=a.stripOuterBlanks(h);if(e.toString()=="false"){alert("Spaces are not permitted in IP addresses.");return false}else{if(e==""){return true}}if(e.search(i)!=-1){var g=e.split(".");for(var f=0;f<4;f++){if(!(c.validateIpSegment(g[f]))){return false}}return true}else{alert("Server names not enabled. Please enter an IP address or configure DNS on the TCP/IP page.");return false}};this.validateEmail=function(e){var p=a.stripOuterBlanks(e);if(p.toString()=="false"){alert("Spaces are not permitted in Email addresses.");return false}else{if(p==""){return true}}var l=p.split(";");for(var s=0;s<l.length;s++){p=l[s];var x=/^(.+)@(.+)$/;var v='\\(\\)><@,:\\\\\\"\\.\\[\\]';var o="[^\\s"+v+"]";var w=/^\[?(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]?$/;var f=o+"+";var u="("+f+")";var q=new RegExp("^"+u+"(\\."+u+")*$");var k=new RegExp("^"+f+"(\\."+f+")*$");var g=p.match(x);if(g==null){alert("Email address is invalid (check @ and . characters).");return false}var y=g[1];var z=g[2];for(var r=0;r<y.length;r++){if(y.charCodeAt(r)>127){alert("The Email username contains invalid characters.");return false}}for(var r=0;r<z.length;r++){if(z.charCodeAt(r)>127){alert("The Email domain name contains invalid characters.");return false}}if(y.match(q)==null){alert("The username in this Email address is invalid.");return false}var n=z.match(w);if(n!=null){for(var r=1;r<=4;r++){if(n[r]>255){alert("Domain IP in Email address is invalid.");return false}}return true}var m=new RegExp("^"+f+"$");var h=z.split(".");var t=h.length;for(var r=0;r<t;r++){if(h[r].search(m)==-1){alert("The domain in this Email address is invalid.");return false}}}return true};this.validateHostname=function(e){var h=/^\s*[a-zA-Z]\s*$/;var g=/^\s*[a-zA-Z][a-zA-Z\d\-]*[a-zA-Z\d]\s*$/;var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces are not permitted in hostnames.");return false}else{if(f==""){return true}}if(a.stripBlanks(e).length==1){if(e.search(h)==-1){alert("The host name is invalid.");return false}}else{if(e.search(g)==-1){alert("The host name is invalid.");return false}}return true};this.validateHostnameExt=function(e){var k=/^\s*[a-zA-Z\d]\s*$/;var i=/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$/;var l=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;var g=a.stripOuterBlanks(e);if(g.toString()=="false"){alert("Spaces not permitted in hostnames.");return false}else{if(g==""){return true}}if(a.stripBlanks(e).length==1){if(e.search(k)==-1){alert("The host name is invalid.");return false}}else{if(e.indexOf(".")!=-1){if(e.search(l)!=-1){var h=e.split(".");for(var f=0;f<4;f++){if(!(c.validateIpSegment(h[f]))){alert("The host name is invalid.");return false}}}else{alert("The host name is invalid.");return false}}else{if(e.search(i)==-1){alert("The host name is invalid.");return false}}}return true};this.validateUri=function(h){var e=a.stripOuterBlanks(h);if(e.toString()=="false"){alert("Spaces not permitted in IP addresses or server names.");return false}else{if(e==""){return true}}var i=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;if(e.search(i)!=-1){var g=e.split(".");for(var f=0;f<4;f++){if(!(c.validateIpSegment(g[f]))){return false}}return true}else{return c.validateDomain(e)}};this.validateDomain=function(f){if(f==""){return true}else{var l=a.stripOuterBlanks(f);if(l.toString()=="false"){alert("Spaces not permitted within domain name.");return false}else{var k=/^[a-zA-Z\d]$/;var h=/^[a-zA-Z\d][a-zA-Z\d\-\_]*[a-zA-Z\d]$/;var j=l.split(".");var e=j.length;for(var g=0;g<e;g++){if(j[g].length==1){if(j[g].search(k)==-1){alert("The domain name is invalid.");return false}}else{if(g==0){if(j[g].search(h)==-1){alert("The host name is invalid.");return false}}else{if(j[g].search(h)==-1){alert("The domain name is invalid.");return false}}}}}}return true};this.validateDomainSuff=function(f){if(f==""){return true}else{var l=a.stripOuterBlanks(f);if(l.toString()=="false"){alert("Spaces not permitted within domain name.");return false}else{var k=/^[a-zA-Z\d]$/;var h=/^[a-zA-Z\d][a-zA-Z\d\-\_]*[a-zA-Z\d]$/;var j=l.split(".");var e=j.length;if(e<2){alert("This domain suffix is too short, and must be in a form like: mydomain.com");return false}for(var g=0;g<e;g++){if(j[g].length==1){if(j[g].search(k)==-1){alert("The domain name is invalid.");return false}}else{if(j[g].search(h)==-1){alert("The domain name is invalid.");return false}}}}}return true};this.validateUserPass=function(e){var f=/^[a-zA-Z\d\_]*$/;if(e.search(f)==-1){alert("Username and password may only contain letters, numbers and underscore.");return false}return true};this.validateUserPassPPP=function(e){var f=/^\s*[^\<\>\&]*\s*$/;if(e==""){return true}if(a.stripOuterBlanks(e).toString()=="false"){alert("Username and password may not contain spaces.");return false}if(e.search(f)==-1){alert("Username and password may not contain these symbols: <>&");return false}return true};this.validateUserInPPP=function(e){var f=/^\s*[^\<\>\&]*\s*$/;if(e==""){alert("Username and password for incoming calls may not be empty.");return false}if(a.stripOuterBlanks(e).toString()=="false"){alert("Username and password may not contain spaces.");return false}if(e.search(f)==-1){alert("Username and password may not contain these symbols: <>&");return false}return true};this.getIPAddressValidationMethod=function(i,h,g,f){var e=function(l){if(l.search(/\:/)>=0&&!h){return elon.Error.getInstance(b.ERR_VAL_IPV6_NOT_ALLOWED)}var k=null;var j=c.validateIPv4(l);if(d.isNull(j)){if(i){return null}else{return elon.Error.getInstance(b.ERR_VAL_IPV4_NOT_ALLOWED)}}else{if(i){k=j}}j=c.validateIPv6(l);if(d.isNull(j)){if(h){return null}else{return elon.Error.getInstance(b.ERR_VAL_IPV6_NOT_ALLOWED)}}else{if(h){k=j}}j=c.validateFullHostname(l);if(d.isNull(j)){if(g){return null}else{return elon.Error.getInstance(b.ERR_VAL_FULL_HOSTNAMES_NOT_ALLOWED)}}else{if(g){k=j}}j=c.validateSubDomainName(l);if(d.isNull(j)){if(f){return null}else{if(g){return elon.Error.getInstance(b.ERR_VAL_FULL_HOSTNAME_TOO_SHORT)}else{return elon.Error.getInstance(b.ERR_VAL_SUBDOMAIN_NAMES_NOT_ALLOWED)}}}else{if(f){k=j}}if(k==null){k=elon.Error.getInstance(b.ERR_VAL_FIELDS_MARKED)}return k};return e};this.validateServerRef=function(e){var f;if(e=="127.0.0.1"){f=elon.Error.getInstance(b.ERR_ERR_MESSAGE,{msg:"The IP address '127.0.0.1' always references the localhost, and cannot be used to create a reference to another server!"})}else{f=this.getIPAddressValidationMethod(true,true,true,false)(e)}if(f==null){f=true}else{alert(f.faultString);f=false}return f};this.validateDnsRef=function(e){var f=this.getIPAddressValidationMethod(true,true,false,false)(e);if(f==null){f=true}else{alert(f.faultString);f=false}return f};this.validateIPv4Ref=function(e){var f=this.getIPAddressValidationMethod(true,false,false,false)(e);if(f==null){f=true}else{alert(f.faultString);f=false}return f};this.validateIPv6Ref=function(e){var f=this.getIPAddressValidationMethod(false,true,false,false)(e);if(f==null){f=true}else{alert(f.faultString);f=false}return f};this.validateIPv4Segment=function(e){var g=null;var f=a.stripOuterBlanks(e);if(f.toString()=="false"){g=elon.Error.getInstance(b.ERR_VAL_IP_SPACES)}else{if((f<0)||(f>255)||(f=="")){g=elon.Error.getInstance(b.ERR_VAL_IPV4_SEGMENT)}}return g};this.validateIPv4=function(e){var h=null;var i=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;var k=a.stripOuterBlanks(e);if(k.toString()=="false"){h=elon.Error.getInstance(b.ERR_VAL_IP_SPACES)}else{if(k=="127.0.0.1"){h=elon.Error.getInstance(b.ERR_ERR_MESSAGE,{msg:"The IP address '127.0.0.1' always references the localhost, and cannot be used to create a reference to another server!"})}else{if(k.search(i)!=-1){var g=k.split(".");for(var f=0;f<4;f++){h=c.validateIPv4Segment(g[f]);if(d.isSafe(h)){break}}}else{h=elon.Error.getInstance(b.ERR_VAL_IP_ADDRESS)}}}return h};this.validateIPv6=function(l){var k=null;var m=/^(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}(?:(?:\/(\d{1,3}))?)$/;var g=/^(?:(?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)::(?:(?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)(?:(?:\/(\d{1,3}))?)$/;var f=/^(?:(?:[0-9A-Fa-f]{1,4}:){6,6})(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})(?:(?:\/(\d{1,3}))?)$/;var h=/^(?:(?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)::(?:(?:[0-9A-Fa-f]{1,4}:)*)(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})(?:(?:\/(\d{1,3}))?)$/;var i=a.stripOuterBlanks(l);if(i.toString()=="false"){k=elon.Error.getInstance(b.ERR_VAL_IP_SPACES)}else{var e=i.match(m);if(!d.isSafe(e)){e=i.match(g)}if(!d.isSafe(e)){e=i.match(f)}if(!d.isSafe(e)){e=i.match(h)}if(!d.isSafe(e)){k=elon.Error.getInstance(b.ERR_VAL_IP_ADDRESS)}else{if(e.length>4){for(var j=1;j<5;j++){if(parseInt(e[j],10)>255){k=elon.Error.getInstance(b.ERR_VAL_IPV4_SEGMENT);break}}if((e.length>5)&&(parseInt(e[5],10)>128)){k=elon.Error.getInstance(b.ERR_VAL_IPV6_PREFIX)}}else{if((e.length>1)&&(parseInt(e[1],10)>128)){k=elon.Error.getInstance(b.ERR_VAL_IPV6_PREFIX)}}}}return k};this.validateFullHostname=function(n){var m=null;var h=a.stripOuterBlanks(n);if(h.toString()=="false"){m=elon.Error.getInstance(b.ERR_VAL_HOSTNAME_SPACES)}else{var f=/^[a-zA-Z\d]$/;var g=/^[a-zA-Z\d][a-zA-Z\d\-]*[a-zA-Z\d]$/;var k=/^[a-zA-Z\d][a-zA-Z\d\-\_]*[a-zA-Z\d]$/;var e=h.split(".");var l=e.length;if(l<3&&l!=1){m=elon.Error.getInstance(b.ERR_VAL_DOMAIN_NAME)}else{if(l==1){if(h.length==1){if(h.search(f)==-1){m=elon.Error.getInstance(b.ERR_VAL_HOSTNAME)}}else{if(h.search(g)==-1){m=elon.Error.getInstance(b.ERR_VAL_HOSTNAME)}}}else{for(var j=0;j<l;j++){if(e[j].length==1){if(e[j].search(f)==-1){m=elon.Error.getInstance(b.ERR_VAL_HOSTNAME);break}}else{if((j==0)&&(e[j].search(g)==-1)){m=elon.Error.getInstance(b.ERR_VAL_HOSTNAME);break}else{if(e[j].search(k)==-1){m=elon.Error.getInstance(b.ERR_VAL_DOMAIN_NAME);break}}}}}}}return m};this.validateSubDomainName=function(e){var g=null;var h=/^\s*[a-zA-Z\d]\s*$/;var f=/^\s*[a-zA-Z\d][a-zA-Z\d\-\_]*[a-zA-Z\d]\s*$/;var i=a.stripOuterBlanks(e);if(i.toString()=="false"){g=elon.Error.getInstance(b.ERR_VAL_HOSTNAME_SPACES)}else{if((i.length==1)&&(i.search(h)==-1)){g=elon.Error.getInstance(b.ERR_VAL_HOSTNAME)}else{if(i.search(f)==-1){g=elon.Error.getInstance(b.ERR_VAL_HOSTNAME)}}}return g};this.validateYear=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=2000)&&(f<=2038)&&(f!="")){return true}else{alert("Year is limited to values between 2000 and 2038.");return false}}};this.validateISODate=function(g){var f=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var l;var h=a.stripOuterBlanks(g);if(h.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var j=h.split("-");var i=parseInt(j[0],10);var k=parseInt(j[1],10);var e=parseInt(j[2],10);if((i>=2000)&&(i<=2038)&&(i!="")){if((k>0)&&(k<13)){if(((0==(i%4))&&((0!=(i%100))||(0==(i%400))))&&k==2){l=29}else{l=f[k-1]}if((e>0)&&(e<=l)){return true}else{alert("Day is limited to values between 1 and "+f[k-1]+"in this Month.");return false}}else{alert("Month is limited to values between 1 and 12.");return false}}else{alert("Year is limited to values between 2000 and 2038.");return false}}};this.validateHourMinOffset=function(e){return((c.validateHour(e.substring(1,e.indexOf(":"))))&&(c.validateMinSec(e.substr(e.indexOf(":")+1))))};this.validateHourMin=function(e){return((c.validateHour(e.substring(0,e.indexOf(":"))))&&(c.validateMinSec(e.substr(e.indexOf(":")+1))))};this.validateHourMinOffsetAcceptEmpty=function(e){if(e==""||e==null){return true}return((c.validateHour(e.substring(1,e.indexOf(":"))))&&(c.validateMinSec(e.substr(e.indexOf(":")+1),true)))};this.validateHourMinAcceptEmpty=function(e){if(e==""||e==null){return true}return((c.validateHour(e.substring(0,e.indexOf(":"))))&&(c.validateMinSec(e.substr(e.indexOf(":")+1))))};this.validateHour=function(f){var e=a.stripOuterBlanks(f);if(e.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((e>=0)&&(e<=23)&&(e!="")&&(e.length<3)){return true}else{alert("Hour value is invalid.");return false}}};this.validateMinSec=function(e,g){if(g&&(e==""||e==null)){return true}var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=59)&&(f!="")&&(f.length<3)){return true}else{alert("Minutes and seconds must be a value between 0 and 59");return false}}};this.validateLongitudeDeg=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=-179)&&(f<=180)&&(f!="")&&(f.length<5)){return true}else{alert("Longitude must be a value between -179 and 180");return false}}};this.validateLatitudeDeg=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=-90)&&(f<=90)&&(f!="")){return true}else{alert("Latitude must be a value between -90 and 90");return false}}};this.validateLatitudeFloat=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=-90)&&(f<=90)&&(f!="")){return true}else{alert("Latitude must be a value between -90 and 90");return false}}};this.validateLongitudeFloat=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=-179.9999)&&(f<=180)&&(f!="")){return true}else{alert("Longitude must be a value between -179.9999 and 180.0");return false}}};this.validateDoubleFloatPos=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*\.?[\d]*$/;var h=(g.search(e)==-1);g=parseFloat(g);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=1.7976931348623157e+308)){return true}else{alert("Value must be between 0 and 1.7976931348623157E+308.");return false}}};this.validateDoubleFloat=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*\.?[\d]*$/;var h=(g.search(e)==-1);g=parseFloat(g);if((!isNaN(g))&&(!h)&&(g>=-1.7976931348623157e+308)&&(g<=1.7976931348623157e+308)){return true}else{alert("Value must be between -1.7976931348623157e308 and 1.7976931348623157E+308.");return false}}};this.validateMd5Raw=function(h){var i=a.stripBlanks(h);var g=i.split(":");if(g.length==16){var e=/^[a-fA-F\d]{2}$/;for(var f=0;f<16;f++){if(g[f].search(e)==-1){alert("MD5 key is invalid. Please provide a key in the from '12:34:56:78:9A:BC:DE:F0:12:34:56:78:9A:BC:DE:F0'");return false}}return true}else{var j=/^[a-fA-F\d]{32}$/;if(i.search(j)==-1){alert("MD5 key is invalid. Please provide a key in the from '12:34:56:78:9A:BC:DE:F0:12:34:56:78:9A:BC:DE:F0'");return false}return true}};this.validateMd5Hashed=function(e){var f=a.stripBlanks(e);if(f.length<16){alert("Secret phrase must have at least 16 characters not counting spaces.");return false}return true};this.validateLwDomain=function(f){var m=a.stripBlanks(f);if(m.length==0){return true}var i=/^[a-fA-F\d]{2}$/;if(m.search(i)!=-1){return true}var h=/^[a-fA-F\d]{6}$/;if(m.search(h)!=-1){return true}var l=/^[a-fA-F\d]{12}$/;if(m.search(l)!=-1){return true}var g=m.split(":");var j=g.length;if((j==6)||(j==3)||(j==1)){for(var e=0;e<j;e++){if(g[e].search(i)==-1){alert("LonWorks domain is invalid.");return false}}return true}else{alert("LonWorks domain must be 0, 1, 3, or 6 hexadecimal bytes.");return false}};this.validateLwSubnet=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=1)&&(f<=255)&&(f!="")){return true}else{alert("LonWorks subnet must be between 1 and 255.");return false}}};this.validateLwNode=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=1)&&(f<=127)&&(f!="")){return true}else{alert("LonWorks node ID must be between 1 and 127.");return false}}};this.validateSnvtTimeSec=function(f){var e=a.stripOuterBlanks(f);if(e.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var g=/^\s*\d{0,4}\.?\d?\s*$/;if(e.search(g)==-1){alert("Time values must be between 0.0 and 6553.5 seconds.");return false}else{if(((e>=0)&&(e<=6553.5))||(e=="")){return true}else{alert("Time values must be between 0.0 and 6553.5 seconds.");return false}}}};this.validatePhonePrefix=function(e){var g=a.stripBlanks(e);var f=new RegExp("^[\\s\\d\\*\\#ABCDRW\\!\\@\\&\\,\\;\\^\\>+]*$");if(g.search(f)==-1){alert("Phone numbers may only contain digits, spaces, and the following characters: * # A B C D R W ! @ & , ; ^ > +");return false}else{return true}};this.validateMbusPollRate=function(f){var e=a.stripOuterBlanks(f);if(e.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var g=/^\s*\d{0,5}\.?\d?\s*$/;if(e.search(g)==-1){alert("The poll rate must be between 0 and 65534 seconds.");return false}else{if(((parseInt(e,10)>=0)&&(parseInt(e,10)<=65534))||(e=="")){return true}else{alert("The poll rate must be between 0 and 65534 seconds.");return false}}}};this.validateMbusPtName=function(e){var f=new RegExp("^\\s*MBS_[^\\<\\>\\&]+\\s*$");if(e.search(f)==-1){alert("Point names must begin with 'MBS_' and may not contain these symbols: <>&");return false}return true};this.validateMbusPriAddr=function(e){var f=/^\s*\d{0,3}\s*$/;if(e.search(f)==-1){alert("The primary address must be between 0 and 250.");return false}else{if(((parseInt(e,10)>=0)&&(parseInt(e,10)<=250))||(e=="")){return true}else{alert("The primary address must be between 0 and 250.");return false}}};this.validateMbusSecAddr=function(e){var f=/^\s*(F|\d){0,8}\s*$/;if(e.search(f)==-1){alert("The secondary address must be between 00000000 and 99999999. Any or all digits can optionally be replaced with F (wildcard)");return false}return true};this.validateMbusManId=function(e){var f=/^[A-Z]{3}$/;if(e.search(f)==-1){alert("The Man Id must consist of three upper case characters");return false}return true};this.validateUCPTDesc=function(e){if(e.length>227){alert("Description length is restricted to 227 characters");return false}return true};this.validateValueDefName=function(e){var f=/^[a-zA-Z_][\da-zA-Z_\.\-]*$/;if(e.search(f)==-1){alert("Preset names have to start with a letter or '_', and may only contain these characters: letters, numbers, '.', '-' and '_'");return false}return true};this.validateUCPTalarmGroup=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=127)&&(f!="")){return true}else{alert("Value must be between 0 and 127.");return false}}};this.validateAlias=function(e){var f=/^\s*[^\,\/]*\s*$/;if(e.search(f)==-1){alert("Data Point alias names may not contain commas ',' or forward slashes '/'");return false}return true};this.validateUCPTExceptionName=function(e,g){var f=/^\s*[^\<\>\&\s]*\s*$/;if(e.search(f)==-1){if(!g){alert("ExceptionName fields may not contain spaces or any of these symbols: <> &")}return false}else{if(e.length>27){if(!g){alert("ExceptionName length is restricted to 27 characters")}return false}}return true};this.validatePin=function(e){var f=/^\s*[0-9]*\s*$/;if(e.search(f)==-1){alert("PIN number may only contain numbers");return false}return true};this.validateMsgCode=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=79)&&(f!="")){return true}else{alert("Message code must be between 0 and 79.");return false}}};this.validateRawHex=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\da-fA-F]*$/;var h=(g.search(e)==-1);if((!h)&&(g.length%2==0)){return true}else{alert("Value must be single or multiple raw hex bytes (00 - FF)");return false}}};this.validateNumber=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{f=parseFloat(f);if(!isNaN(f)){return true}else{alert("Value must be Number.");return false}}};this.validateInt=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*$/;var h=(g.search(e)==-1);g=parseInt(g,10);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=65535)){return true}else{alert("Value must be integer between 0 and 65535.");return false}}};this.validateIntHex=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\da-fA-F]*$/;var h=(g.search(e)==-1);g=parseInt(g,16);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=65535)){return true}else{alert("Value must be between 0x0000 and 0xFFFF.");return false}}};this.validateByte=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*$/;var h=(g.search(e)==-1);g=parseInt(g,10);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=255)){return true}else{alert("Value must be between 0 and 255.");return false}}};this.validateByteHex=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\da-fA-F]*$/;var h=(g.search(e)==-1);g=parseInt(g,16);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=255)){return true}else{alert("Value must be between 0x00 and 0xFF.");return false}}};this.validateIntAsBytes=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*$/;var h=(g.search(e)==-1);g=parseInt(g,10);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=8191)){return true}else{alert("Value must be between 0 and 8191.");return false}}};this.validatePercent=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=100)&&(f!="")){return true}else{alert("Value must be between 0% and 100%");return false}}};this.validateUnsignedQuad=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=2147483647)&&(f!="")){return true}else{alert("Value must be between 0 and 2147483647.");return false}}};this.validateUCPTpollRate=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=214748364.7)&&(f!="")){return true}else{alert("Value must be between 0 and 214748364.7.");return false}}};this.validateSoapTimeout=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=10)&&(f<=2147483647)&&(f!="")){return true}else{alert("Value must be between 10 and 2147483647.");return false}}};this.validateUCPTpriority=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=255)&&(f!="")){return true}else{alert("Value must be between 0 and 255.");return false}}};this.validateUCPTmaxTxTransactions=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=32767)&&(f!="")){return true}else{alert("Value must be between 1 and 32767.");return false}}};this.validateUCPTretryCount=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=15)&&(f!="")){return true}else{alert("Value must be between 0 and 15.");return false}}};this.validateUCPTlogSize=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=2147483.647)&&(f!="")){return true}else{alert("Value must be between 0 and 2147483.647.");return false}}};this.validateSNVTElapsedTm=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{if((f>=0)&&(f<=5662310399.9)&&(f!="")){return true}else{alert("Value must be between 0.0 and 5662310399.9 seconds.");return false}}};this.validateSNVTsetting=function(e){var i=e.split(" ");var g=false,h=false,f=false;if(i.length!=3){alert("SNVT_setting must be formatted as three fields separated by spaces");return false}else{g=((i[0]=="SET_NUL")||(i[0]=="SET_OFF")||(i[0]=="SET_ON")||(i[0]=="SET_DOWN")||(i[0]=="SET_UP")||(i[0]=="SET_STOP")||(i[0]=="SET_STATE"));h=(((parseFloat(i[1])>=0)&&(parseFloat(i[1])<=100))||(parseFloat(i[1])==127.5));f=(((parseFloat(i[2])>=-359.98)&&(parseFloat(i[2])<=360))||(parseFloat(i[2])==655.34))}if(g&&h&&f){return true}else{alert("Value is out of range");return false}};this.validateSNVTswitch=function(f){var g=f.split(" ");var e=false,h=false;if(g.length!=2){alert("SNVT_switch must be formatted as two fields separated by spaces");return false}else{e=(((parseFloat(g[0])>=0)&&(parseFloat(g[0])<=100))||(parseFloat(g[0])==127.5));h=((parseInt(g[1],10)==-1)||(parseInt(g[1],10)==0)||(parseInt(g[1],10)==1))}if(e&&h){return true}else{alert("Value is out of range");return false}};this.validateFileName=function(e){var f=/^\s*[^\/\\\:\*\?\"\<\>\|]*\s*$/;if(e.search(f)==-1){alert('Names may not contain any of these symbols: / \\ : * ? " < > |');return false}return true};this.validateModbusPtName=function(e){var f=new RegExp("^\\s*MOD_[^\\<\\>\\&]+\\s*$");if(e.search(f)==-1){alert("Point names must begin with 'MOD_' and may not contain these symbols: <>&");return false}return true};this.validateModbusAddress=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*$/;var h=(g.search(e)==-1);g=parseInt(g,10);if((!isNaN(g))&&(!h)&&(g>0)&&(g<=255)){return true}else{alert("Value must be between 1 and 255.");return false}}};this.validateModbusMaxElements=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\d]*$/;var h=(g.search(e)==-1);g=parseInt(g,10);if((!isNaN(g))&&(!h)&&(g>=0)&&(g<=255)){return true}else{alert("Value must be between 0 and 255.");return false}}};this.validateModbusAddressHex=function(f){var g=a.stripOuterBlanks(f);if(g.toString()=="false"){alert("Spaces not permitted within number fields.");return false}else{var e=/^[\da-fA-F]*$/;var h=(g.search(e)==-1);g=parseInt(g,16);if((!isNaN(g))&&(!h)&&(g>0)&&(g<=255)){return true}else{alert("Value must be between 0x01 and 0xFF.");return false}}};this.validateSpaceless=function(e){var f=a.stripOuterBlanks(e);if(f.toString()=="false"){alert("Spaces not permitted within number fields.");return false}return true};this.validateHexHelper=function(f,j){var g=a.stripOuterBlanks(f);var e=new RegExp("^[\\da-fA-F]{"+j+"}$");var h=(g.search(e)==-1);g=parseInt(g,16);return((!isNaN(g))&&(!h))};this.validateHex2=function(e){if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,2)){alert("One digit hex number required.");return false}return true};this.validateHex4=function(e){if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,4)){alert("Four digit hex number required.");return false}return true};this.validateHex6=function(e){if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,6)){alert("Six digit hex number required.");return false}return true};this.validateHex12=function(e){if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,12)){alert("Twelve digit hex number required.");return false}return true};this.validateHex12or24=function(e){if(e==null||e==""){return true}if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,12)&&!this.validateHexHelper(e,24)){alert("12 or 24 digit hex number required.");return false}return true};this.validateHex16=function(e){if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,16)){alert("16 digit hex number required.");return false}return true};this.validateHex24=function(e){if(e==null||e==""){return true}if(!this.validateSpaceless(e)){return false}if(!this.validateHexHelper(e,24)){alert("24 digit hex number required.");return false}return true};this.validateUCPTformatDescription=function(e){var f=/^\s*(?:\#([\da-fA-F]{16})\[(\d)\]\.)?(\w+)\#?(\w+)?\s*$/;if(e.search(f)==-1){alert("Format descriptions must follow the form: #program-id[scope].format-name#locale");return false}return true};this.validateUCPTname=function(e){if(!e){alert("Please enter name");return false}else{if(e.match(/'|"/)){alert("\" and ' characters are invalid. Please enter name");return false}else{if(e.match(/<|>/)){alert("< and > characters are invalid. Please enter name");return false}else{if(e.match(/#\d+/)){alert('Ending names with "#DIGITS" is invalid. Please enter name');return false}}}}return true};this.validateUCPTnameElement=function(e){if(!e){alert("Please enter name");return false}else{if(e.match(/'|"/)){alert("\" and ' characters are invalid. Please enter name");return false}else{if(e.search("/")!=-1){alert('"/" characters are invalid. Please enter name');return false}else{if(e.match(/<|>/)){alert("< and > characters are invalid. Please enter name");return false}else{if(e.match(/#\d+/)){alert('Ending names with "#DIGITS" is invalid. Please enter name');return false}}}}}return true};this.validateDbName=function(e){if(!c.validateUCPTnameElement(e)){return false}else{if(e.length>14){alert("Network name may not have more than 14 characters");return false}else{return true}}}};elon.ValidationObject.instance=null;elon.ValidationObject.getInstance=function(){if(elon.ValidationObject.instance==null){elon.ValidationObject.instance=new elon.ValidationObject()}return elon.ValidationObject.instance};elon.ConnectionManagerObject=function(e){this.readInfo=function(z,B,y){var A={Item:h.js2Xml({iLONSystemService:{UCPTsystemInfoType:"SI_"+z}}),method:"SystemService_Read_Info",callback:j(B)};for(var x in y){A[x]=y[x]}k.soapCall(A)};this.fetchInfo=function(y,z,x){if(r[y]||s[y]){z(r[y]||s[y],null,null,y)}else{this.readInfo(y,z,x)}};this.writeInfo=function(y,A,C,B){t();if(C){a(y,A,B);return}var z=true;for(var x in r){z=false}r[y]=A;if(z){k.addSubmitOperation(u)}};this.writeCm=function(x){t();if(q==null){k.addSubmitOperation(g);k.addSubmitCallback(o)}q=x};this.writeCmNow=function(y,x){t();q=y;g(null,x||function(){})};var t=function(){if(w.m_changeCB){for(var x=0;x<w.m_changeCB.length;x++){w.m_changeCB[x]()}}};this.addChangeCB=function(x){if(!this.m_changeCB){this.m_changeCB=[]}this.m_changeCB.push(x)};this.initCm=function(A,y){if(this.m_cmCB){this.m_cmCB.addCb(A)}else{this.m_cmCB=n([A],this);var z={method:"ConnectionManager_List",callback:this.m_cmCB.listHandler};for(var x in y){z[x]=y[x]}k.soapCall(z)}};this.fetchCm=function(y,x){if(q||s.CM){y(q||s.CM,null,null,"CM")}else{this.initCm(y,x)}};this.fetchSoap=function(y,x){this.fetchCm(this.m_FetchSoapCB(y,this),x)};var l=function(E,D,B){var A=elon.ReadyManager.getInstance();var z=B||v.concat("CM");A.readyCB(z,E);var x=m(A);for(var y=0;y<z.length;y++){if(z[y]!="RTR"){if(z[y]=="CM"){var C=true}else{w[((D=="fetch")?D:"read")+"Info"](z[y],x)}}}if(C){w[D+"Cm"](x)}};this.initAll=function(y,x){l(y,"init",x)};this.fetchAll=function(y,x){l(y,"fetch",x)};this.deleteWebService=function(y){var A=this.m_DelWebService(y,this);k.addSubmitOperation(A.m_cb);var x=q||s.CM;for(var z=0;z<x.Services.WebService.length;z++){if(x.Services.WebService[z].UCPTindex==y){x.Services.WebService.splice(z,1)}}return A};this.m_DelWebService=elon.Class({constructor:["m_index","parent"],"public":{abort:function(){this.m_abort=true}},"private":{"callback:m_cb":function(){if(this.m_abort){return}var x=k.getItem({type:"CM_Id"});x.Services();x.Services.WebService.push({UCPTindex:this.m_index});k.soapCall({Item:x,method:"ConnectionManager_Delete",callback:function(){}})}}});this.setSubmitCB=function(x){this.m_submitCB=x};this.test=function(x,y){k.soapCall({Item:h.js2Xml({iLONSystemService:{Test:x}}),method:"SystemService_Test",callback:new i(y).cb})};this.createCmArray=function(A){A=A.split("/");var C={Services:{ConfigService:0,MailService:1,MsgService:2,TimeService:3,WebService:4},Connection:{PhoneConnection:6,DDNS:7}};var y={GlobalPPP:2,Services:3,Host:4,Connection:5,Modem:6}[A[0]];var x=elon.WSDLComplexTypes.CM_Config.content[y].type;for(var z=1;z<A.length;z++){x=x.content[C[A[0]][A[z]]].type}var B=(new (elon.SoapTemplateObject.createComplexConstructor(x))()).m_proxy_initAll();return B.m_proxy_convertToSimple()};this.getLns=function(x){if(this.m_lnsCBs){return this.m_lnsCBs.push(x)}else{this.m_lnsCBs=[x]}k.Get({xSelect:'//Item[@xsi:type="LON_Network_Cfg"]',callback:p,id:"volatile"})};this.getLnsFromNet=function(y,x){if(this.m_lnsCBs){return this.m_lnsCBs.push(x)}else{this.m_lnsCBs=[x]}p({Item:[y]})};var m=elon.Class({closure:function(z,y,A,x){if(x=="STATIC"){if(z.UCPTip852RouterPresent!="false"){w.readInfo("RTR",this.m_elonClassClosure)}else{this.m_rm.ready("RTR")}}this.m_rm.ready(x,z)},constructor:["m_rm"]});var j=elon.Class({closure:function(x,z,B){if(this.m_type){elon.elon.enableUI(this.parent,"everything","systemServiceWrite"+this.m_type)}if(x==null){this.m_cb(null,z,B);return}var A=h.str2Js(x.get());for(var y in A){s[y]=A[y];this.m_cb(A[y]||null,z,B,y)}},constructor:["m_cb","m_type","parent"]});var u=function(y,z){for(var x in r){a(x,r[x],z)}r={}};var a=function(x,y,A){var z={iLONSystemService:{}};z.iLONSystemService[x]=y;k.soapCall({Item:h.js2Xml(z),method:"SystemService_Write_Info",callback:A?j(A,x,w):d(x,w)});elon.elon.disableUI(w,"everything","systemServiceWrite"+x)};var d=elon.Class({constructor:["m_type","parent"],closure:function(){elon.elon.enableUI(this.parent,"everything","systemServiceWrite"+this.m_type)}});var g=function(z,y){if(w.m_submitCB){w.m_submitCB(q||s.CM)}if(!q){return}var x=k.convertFromSimple({type:"CM_Config",Item:q});k.soapCall({Item:x,method:"ConnectionManager_Set",callback:f(y)});elon.elon.disableUI(w,"everything","connectionManagerSubmit");q=null};var o=function(x){if(x){return}q=null;var y=k.convertToSimple({Item:w.soapCm});s.CM=y;w.cm=y};var f=elon.Class({constructor:["m_cb"],closure:function(z,x,A){var y={CONNECTED:"PPP_CM_WARNING",PERS_CONNECTED:"PERS_GPRS_CM_WARNING"}[z.UCPTcommMgrState.get()];if(y){elon.Popup.getInstance({elon_url:elon.htmUrl("Alert.htm"),elon_args_obj:{elon_symbol:elon.filter.qualifierToMediumIcon("ilonhw"),elon_title:elon.NlsManagerObject.translate("nls/echelon/COMMON","WARNING"),elon_msg:elon.NlsManagerObject.translate("nls/echelon/CM_Cfg",y)}})}elon.elon.enableUI(w,"everything","connectionManagerSubmit");this.m_cb(z,x,A)}});var n=elon.Class({constructor:["m_cb","parent"],"public":{"callback:listHandler":function(y,x,z){if(y){k.soapCall({Item:y,method:"ConnectionManager_Get",callback:this.m_getCB})}else{this.m_callCBs(y,x,z)}},addCb:function(x){this.m_cb.push(x)}},"private":{"callback:m_getCB":function(y,x,z){if(y){w.soapCm=y;y=k.convertToSimple({Item:y});s.CM=y;w.cm=y}this.m_callCBs(y,x,z)},m_callCBs:function(z,y,A){for(var x=0;x<this.m_cb.length;x++){this.m_cb[x](z,y,A,"CM")}delete this.parent.m_cmCB}}});var i=function(x){var y=x;this.cb=function(z,A,B){y(h.str2Js(z.get()).Test,A,B)}};var p=function(x){delete w.m_lns;if(x&&x.Item&&x.Item.length&&(x.Item[0].UCPTlnsSync.get()!="SYNC_STANDALONE")&&(typeof(x.Item[0].LnsDatabase)!="function")){w.m_lnsDB=x.Item[0].LnsDatabase.UCPTname.get();w.m_lns=x.Item[0].LnsDatabase.UCPTservicePath.get();w.m_lns=w.m_lns.match(new RegExp("^\\/\\/WebService\\[UCPTindex=(\\d)+]"));w.m_lns=w.m_lns&&w.m_lns[1]}if(!w.m_lns){c()}else{w.fetchCm(b)}};var b=function(x){c(w.m_collectLns(x))};this.m_collectLns=function(x){if(!x){return null}var z=w.collectSoap(x);for(var y=0;y<z.length;y++){if((z[y].type=="WST_LNS_PROXY")&&(z[y].serviceIndex==w.m_lns)){return z[y].soapUrl}}};this.collectSoap=function(H){var G=[];try{var E=H.Services.WebService}catch(F){return}for(var D=0;D<E.length;D++){var I=null;var B=null;var y=null;if(H.Host){for(var C=0;C<H.Host.length;C++){if(H.Host[C].UCPTindex==E[D].UCPThostIndex){I=H.Host[C].UCPThostURL;B=H.Host[C].UCPTindex;for(var A=0;A<H.Connection.length;A++){if(H.Connection[A].UCPTindex==H.Host[C].UCPTconnIndex){y=H.Connection[A];break}}break}}}if(!I){continue}if(I=="127.0.0.1"){var x=k.getUrl()}else{var z=E[D].UCPTsslPort?true:false;var x=(z?"https://":"")+elon.filter.hostURL(I)+(z?((E[D].UCPTsslPort=="443")?"":(":"+E[D].UCPTsslPort)):((E[D].UCPTport=="80")?"":(":"+E[D].UCPTport)))+E[D].WebParameters.UCPTsoapPath}G.push({hostIndex:B,serviceIndex:E[D].UCPTindex,UCPThostURL:I,UCPTport:E[D].UCPTport,UCPTsslPort:E[D].UCPTsslPort,UCPTsoapPath:E[D].WebParameters.UCPTsoapPath,soapUrl:x,type:E[D].WebParameters.UCPTwebServiceType,UCPTmaxAge:E[D].WebParameters.UCPTmaxAge,UCPTconnectionType:y&&y.UCPTconnectionType,connectionName:y&&y.UCPTdescription});if(E[D].WebParameters.UCPTretryTime!=null){G[G.length-1].UCPTretryTime=E[D].WebParameters.UCPTretryTime}if(G[G.length-1].UCPTconnectionType=="CT_LAN"){G[x]=G[G.length-1]}}return G};this.m_FetchSoapCB=elon.Class({constructor:["m_cb","parent"],closure:function(x){this.m_cb(this.parent.collectSoap(x))}});this.getLocalHost=function(y,x){var A=this.collectSoap(y);for(var z in A){if(A[z].UCPThostURL=="127.0.0.1"){return elon.Hostmap(k.getUrl()).get(A[z].serviceIndex,x)}}x()};this.getLocalHostIdx=function(y,x){var A=this.collectSoap(y);for(var z in A){if(A[z].UCPThostURL=="127.0.0.1"){return x(A[z].serviceIndex)}}x()};this.fetchLocalHost=function(x){this.fetchCm(this.m_LocalHostCB(x,this,"getLocalHost"))};this.fetchLocalHostIdx=function(x){this.fetchCm(this.m_LocalHostCB(x,this,"getLocalHostIdx"))};this.m_LocalHostCB=elon.Class({constructor:["m_cb","parent","func"],closure:function(x){this.parent[this.func](x,this.m_cb)}});var c=function(x){if(!w.m_lnsCBs){return}w.m_lns=x||false;for(var y=0;y<w.m_lnsCBs.length;y++){w.m_lnsCBs[y](x,w.m_lnsDB)}delete w.m_lnsCBs};var v=["LSPA","NETWORK","RNI","RTR","SECURITY","STATIC","TIME"];var s={};var r={};var q=null;var w=this;var k=elon.SoapServerObject.getInstance(e);var h=elon.XmlParser.getInstance()};new elon.PerServerInstantiator(elon.ConnectionManagerObject);elon.Hostmap=elon.Class({instantiator:"perServer",constructor:function(a){this.m_url=a;this.m_map={};this.m_req={}},"public":{set:function(b,a){for(var c in this.m_map){if(this.m_map[c].reachable&&(this.m_map[c].url==b)){var d=c;break}}if(!d){return}this.m_map[d].name=a;if(!this.m_cb){return}for(var c=0;c<this.m_cb.length;c++){this.m_cb[c](b,a)}},get:function(a,c,b){if(a==null){return""}if(this.m_map[a]){return c(this.m_map[a].name,this.m_map[a].reachable)}if(!this.m_req[a]){this.m_req[a]=[c]}else{this.m_req[a].push(c)}elon.ConnectionManagerObject.getInstance(this.m_url).fetchSoap(this.m_CmCB(a,b),{id:b,noErrMsg:true,msg:'Retriving name for "'+a+'"'})},subscribe:function(a){if(!this.m_cb){this.m_cb=[]}this.m_cb.push(a)}},"private":{"nest:m_CmCB":elon.Class({constructor:["m_serviceIndex","m_id"],closure:function(b){if(!b){return this.m_result("UNKNOWN")}for(var a=0;a<b.length;a++){if(b[a].serviceIndex==this.m_serviceIndex){this.m_backupName=b[a].UCPThostURL;if(b[a].UCPTconnectionType!="CT_LAN"){this.m_backupName+=" ("+b[a].connectionName+")"}this.m_url=b[a].soapUrl;if(((b[a].UCPThostURL!="127.0.0.1")&&(b[a].type=="WST_WEB_BINDER"))||(b[a].type=="WST_LNS_PROXY")||(b[a].UCPTconnectionType!="CT_LAN")){this.m_result()}else{elon.ConnectionManagerObject.getInstance(b[a].soapUrl).readInfo("NETWORK",this.m_ssiNetCB,{id:this.m_id,noErrMsg:true,msg:'Retriving name for "'+b[a].soapUrl+'"'})}}}},"private":{m_result:function(a){var c={name:a||this.m_backupName,reachable:a?true:false,url:this.m_url};this.parent.m_map[this.m_serviceIndex]=c;for(var b=0;b<this.parent.m_req[this.m_serviceIndex].length;b++){this.parent.m_req[this.m_serviceIndex][b](c.name,c.reachable)}delete this.parent.m_req[this.m_serviceIndex]},"callback:m_ssiNetCB":function(a){if(!this.parent.m_req[this.m_serviceIndex]){return}if(a&&(a.UCPTSoftwareDisabledByDownRevHardware=="true")){elon.Popup.getInstance({elon_url:elon.htmUrl("Alert.htm"),elon_args_obj:{elon_symbol:elon.filter.qualifierToMediumIcon("ilonhw"),elon_title:this.m_id.translate("E3_HARDWARE_TITLE"),elon_msg:this.m_id.translate("E3_HARDWARE_MSG")}})}this.m_result(a&&a.UCPThostName)}}})}});Echelon.SmartServerSleuth=elon.Class({"public":{listLonCopies:function(e,f,g){if(!f||!f.length){return g()}if({LON_Fb_Cfg:1,LON_Dp_Cfg:1,LON_Cp_Dp_Cfg:1,LON_Cp_File_Cfg:1}[e]){var a={};var d={};for(var c=0;c<f.length;c++){var b=elon.filter.parentDeviceName(f[c].UCPTname.get());if(!a[b]){a[b]={LON:[],Item:[]}}a[b][(f[c].r_proxy_type=="Item")?"Item":"LON"].push(f[c])}for(var c in a){this.m_getItemAndSoap(f[0].r_proxy_url,"LON_Device_Cfg",c,this.m_ListLonCopiesFbDpCB(a[c],g))}}else{this.m_getSoap(this.m_ListLonCopiesCB(f,g))}},listCopies:function(a,b){this.m_getSoap(this.m_ListCopiesCB(b,a))},findHostIlon:function(a,b){this.m_getItemAndSoap(a.r_proxy_url,"LON_Device_Cfg",elon.filter.parentDeviceName(a.UCPTname.get()),this.m_HostDevSoapCB(b,a.r_proxy_url))},shouldBeRedirected:function(a){return elon.elon.getTopLevelSSO().isIlon()&&{Fb:1}[elon.filter.nameToGenericType(a.UCPTname.get())]&&elon.elon.getTopLevelSSO().isLnsProxyItem({Item:a})}},"private":{m_getSoap:function(d){var c=elon.elon.getTopLevelSSO();var b=c.getUrl();var a=c.isIlon();if(a){elon.ConnectionManagerObject.getInstance(b).fetchSoap(d)}},m_getItemAndSoap:function(c,d,b,h){var e=elon.ReadyManager();var g=elon.elon.getTopLevelSSO();var f=g.getUrl();var a=g.isIlon();e.readyCB(["dev","soap"],h);if(a){elon.ConnectionManagerObject.getInstance(f).fetchSoap(e.createSimpleCB("soap"))}g.getRemocalItem({type:d,Item:b,callback:e.createSimpleCB("dev"),id:"volatile",url:c})},m_HostDevSoapCB:elon.Class({constructor:["m_cb","m_url"],closure:function(b){if(!b.dev||!b.dev.UCPThandle||!b.dev.UCPThandle.get()||!b.soap){return this.m_failed()}var d=elon.elon.getTopLevelSSO();var c=b.dev.UCPThandle.get();this.m_requests=this.m_responses=0;for(var a=0;a<b.soap.length;a++){if(b.soap[a].UCPTsoapPath=="/WSDL/iLON100.WSDL"){this.m_requests++;d.Get({xSelect:'//Item[@xsi:type="LON_Device_Cfg"][UCPThandle="'+c+'"][UCPTlocal="1"]',id:"volatile",callback:this.m_devCB,url:b.soap[a].soapUrl,noErrMsg:true})}}if(!this.m_requests){this.m_failed()}},"private":{m_failed:function(){this.m_cb(this.m_url)},"callback:m_devCB":function(a){this.m_responses++;if(!this.m_success&&a&&a.Item&&a.Item.length){this.m_cb(a.Item[0].r_proxy_url);this.m_success=true}else{if((this.m_responses==this.m_requests)&&!this.m_success){this.m_failed()}}}}}),m_ListCopiesCB:elon.Class({constructor:["m_cb","m_obj"],closure:function(d){if(!d){return this.m_cb([])}this.m_ret=[];var e=elon.elon.getTopLevelSSO();this.m_requests=this.m_responses=0;for(var b=0;b<d.length;b++){if({"/LnsProxy/LnsProxyService":1,"/WSDL/iLON100.WSDL":1}[d[b].UCPTsoapPath]){var c=[];for(var a=0;a<this.m_obj.length;a++){if(this.m_obj[a].r_proxy_url!=d[b].soapUrl){c.push(this.m_obj[a].UCPTname.get())}}if(!c.length){continue}this.m_requests++;e.getRemocalItem({type:this.m_obj[0].r_proxy_type,Item:c,id:"volatile",callback:this.m_devCB,url:d[b].soapUrl,returnArray:true,noErrMsg:true})}}if(!this.m_requests){this.m_cb([])}},"private":{"callback:m_devCB":function(b){this.m_responses++;if(b&&b.length){for(var a=0;a<b.length;a++){this.m_ret.push(b[a])}}if(this.m_responses==this.m_requests){this.m_cb(this.m_ret)}}}}),m_ListLonCopiesCB:elon.Class({constructor:["m_obj","m_cb"],closure:function(c){if(!c){return this.m_cb([])}this.m_ret=[];var d=elon.elon.getTopLevelSSO();this.m_requests=this.m_responses=0;for(var b=0;b<c.length;b++){if(c[b].UCPTsoapPath=="/WSDL/iLON100.WSDL"){for(var a=0;a<this.m_obj.length;a++){if((this.m_obj[a].r_proxy_url==c[b].soapUrl)||(this.m_obj[a].UCPThandle.get()==null)){continue}this.m_requests++;d.Get({xSelect:'//Item[@xsi:type="'+this.m_obj[a].r_proxy_type+'"][UCPThandle="'+this.m_obj[a].UCPThandle.get()+'"]',id:"volatile",callback:this.m_devCB,url:c[b].soapUrl,noErrMsg:true})}}}if(!this.m_requests){this.m_cb([])}},"private":{"callback:m_devCB":function(b){this.m_responses++;if(b&&b.Item){for(var a=0;a<b.Item.length;a++){this.m_ret.push(b.Item[a])}}if(this.m_responses==this.m_requests){this.m_cb(this.m_ret)}}}}),"nest:m_ListLonCopiesFbDpCB":elon.Class({constructor:function(b,a){this.m_obj=b.LON;this.m_cb=a;this.m_rm=elon.ReadyManager();if(b.Item.length){var c=elon.elon.getTopLevelSSO();c.getRemocalItem({type:"LON_"+elon.filter.nameToGenericType(b.Item[0].UCPTname.get())+"_Cfg",Item:b.Item,callback:this.m_driverCB,returnArray:true});this.m_rm.readyCB(["driver","dev"],this.m_ready)}else{this.m_rm.readyCB(["dev"],this.m_ready)}},closure:function(a){if(!a.dev||!a.dev.UCPThandle||!a.dev.UCPThandle.get()||!a.soap){return this.m_cb([])}this.parent.m_ListLonCopiesCB([a.dev],this.m_rm.createSimpleCB("dev"))(a.soap)},"private":{"callback:m_driverCB":function(a){this.m_obj=this.m_obj.concat(a);this.m_rm.ready("driver")},m_primaryKey:{LON_Fb_Cfg:"fbIndex",LON_Cp_File_Cfg:"handle",LON_Cp_Dp_Cfg:"nvIndex",LON_Dp_Cfg:"nvIndex"},"callback:m_ready":function(e){if(!e.dev||!e.dev.length){return this.m_cb([])}this.m_ret=[];var f=elon.elon.getTopLevelSSO();this.m_requests=this.m_responses=0;for(var c=0;c<e.dev.length;c++){for(var b=0;b<this.m_obj.length;b++){var d=this.m_obj[b].r_proxy_type;var a="UCPT"+this.m_primaryKey[d];if(this.m_obj[b][a].get()==null){continue}this.m_requests++;f.Get({xSelect:'//Item[@xsi:type="'+d+'"][starts-with(UCPTname,"'+e.dev[c].UCPTname.get()+'/")]['+a+'="'+this.m_obj[b][a].get()+'"]',url:e.dev[c].r_proxy_url,callback:this.m_itemCB,noErrMsg:true})}}},"callback:m_itemCB":function(b){this.m_responses++;if(b&&b.Item){for(var a=0;a<b.Item.length;a++){this.m_ret.push(b.Item[a])}}if(this.m_responses==this.m_requests){this.m_cb(this.m_ret)}}}})}});elon.NlsManagerObject=elon.Class({constructor:["m_dummy","m_viewObj"],"public":{loadNls:function(c,d,a){this.m_nlsId=c+((d!=null)?("_"+d):"");this.m_elon=elon.elon;if(elon.NlsManagerObject.m_map[this.m_nlsId]!=null){elon.ExceptionHandler().call(a,[elon.NlsManagerObject.m_map[this.m_nlsId]]);return}this.m_nlsCallback=a;this.m_rm=elon.ReadyManager.getInstance();var b=elon.rootUrl("nls/echelon/COMMON");this.m_rm.readyCB((c!=b)?[b,c]:[c],this.m_callback);this.m_Fetch(b,d);if(c!=b){this.m_Fetch(c,d)}}},"private":{"nest:m_Fetch":elon.Class({constructor:function(b,c){this.m_ac=b;c=c=="en"?"":c;this.m_prefix=(b+(c?("_"+c):""));var a=elon.NlsManagerObject.m_file[this.m_prefix];if(a){if(a.readyCB){a.readyCB([b],this.m_ready)}else{this.parent.m_rm.ready(b,a)}return}if((a==false)&&c){this.parent.m_Fetch(this.m_ac)}else{elon.NlsManagerObject.m_file[this.m_prefix]=this.parent.m_rm;elon.getTextFromServer(this.m_prefix+".properties",this.m_cb)}},"private":{"callback:m_ready":function(a){this.parent.m_rm.ready(this.m_ac,a[this.m_ac])},"callback:m_cb":function(f,c){if(c==200){var g=elon.StringHelperObject.getInstance();var b=f.split("\n");var e={};for(var d=0;d<b.length;d++){if(b[d]!=""&&b[d].substr(0,1)!="#"){var a=g.leaveInnerBlanks(b[d].substr(0,b[d].indexOf("=")));e[a]=g.leaveInnerBlanks(b[d].substr(b[d].indexOf("=")+1))}}elon.NlsManagerObject.m_file[this.m_prefix]=e;this.parent.m_rm.ready(this.m_ac,e)}else{elon.NlsManagerObject.m_file[this.m_prefix]=false;if((c==404)&&(this.m_prefix!=this.m_ac)){if(!elon.NlsManagerObject.m_map[this.m_ac]){this.parent.m_Fetch(this.m_ac)}else{this.parent.m_rm.ready(this.m_ac,elon.NlsManagerObject.m_map[this.m_ac])}}else{if(this.parent.m_viewObj){this.parent.m_viewObj.f_enableUI()}this.parent.m_elon.setErrMsg('Error "'+((c&&c.faultString)||c)+'" while loading nls file "'+this.m_prefix+'.properties". Press <F5>')}}}}}),"callback:m_callback":function(d){var c={};for(var b in d){for(var a in d[b]){c[a]=d[b][a]}}elon.ExceptionHandler().call(this.m_nlsCallback,[elon.NlsManagerObject.m_map[this.m_nlsId]=c])}}});elon.NlsManagerObject.getInstance=elon.NlsManagerObject;elon.NlsManagerObject.m_file={};elon.NlsManagerObject.m_map={};elon.NlsManagerObject.translate=function(a,b){return elon.NlsManagerObject.m_map[elon.rootUrl(a)][b]};elon.CallbackHandler=function(d,a){var c=d;var b=a;this.method=function(){return b.apply(c,arguments)}};elon.EventManager=function(d){var c=d;var b=function(e){var f=e;this.method=function(g){return c[f].call(c,elon.util.evt.sourceObj(g))}};var a=function(e){var f=e;this.method=function(g){return f.call(c,elon.util.evt.sourceObj(g))}};this.create=function(e){return(new ((typeof(e)=="string")?b:a)(e)).method}};elon.ReadyManager=elon.Class({constructor:function(){this.m_ready={};this.m_readyRet={};this.m_cb=[]},"public":{ready:function(b,a){this.m_readyRet[b]=a;this.m_ready[b]=true;this.m_callReady()},isReady:function(c){var a={};for(var b=0;b<c.length;b++){if(!this.m_ready[c[b]]){return false}a[c[b]]=this.m_readyRet[c[b]]}return a},readyCB:function(a,b){this.m_cb.push({prerequisite:a,callback:b});this.m_callReady()},createSimpleCB:function(b,a){return this.m_SimpleCB(b,a)}},"private":{m_callReady:function(){var c;for(var b=0;b<this.m_cb.length;b++){if(this.m_cb[b].callback&&(c=this.isReady(this.m_cb[b].prerequisite))){var a=this.m_cb[b].callback;delete this.m_cb[b].callback;a(c)}}},"nest:m_SimpleCB":elon.Class({constructor:["m_prerequisite","m_args"],closure:function(c){if(this.m_args){var a={};for(var b=0;b<this.m_args.length;b++){a[this.m_args[b]]=arguments[b]}c=a}this.parent.ready(this.m_prerequisite,c)}})}});elon.ColorTableObject=function(){var c=this;var b=new Object();var a=0;this.getColor=function(f){if(b[f]==null){if(a<elon.ColorTableObject.colorPresets.length){b[f]=elon.ColorTableObject.colorPresets[a]}else{var d="rgb(";for(var e=0;e<3;e++){d+=Math.round(Math.random()*155+100);if(e<2){d+=","}else{d+=")"}}b[f]=d}a++}return b[f]}};elon.ColorTableObject.colorPresets=new Array("rgb(255,150,150)","rgb(150,255,150)","rgb(150,150,255)","rgb(150,150,150)","rgb(255,255,150)","rgb(150,255,255)");elon.ColorTableObject.instance=null;elon.ColorTableObject.getInstance=function(){if(elon.ColorTableObject.instance==null){elon.ColorTableObject.instance=new elon.ColorTableObject()}return elon.ColorTableObject.instance};elon.ModAddressCalculator=elon.Class({constructor:function(a,e){var d=e.getItem({type:"DpTree_Data",Item:a});var c=0;for(var b=0;b<d.Item.length;b++){if(d.Item[b].UCPTstartAddress.get()>d.Item[c].UCPTstartAddress.get()){c=b}}this.m_lastModDp=d.Item[c]},"public":{lastDp:function(){return this.m_lastModDp},nextAddr:function(){var b=this.m_lastModDp.UCPTformatDescription.get().match(/[^.]*\.?(\w+)/);var a=(b&&this.m_len[b[1]])||this.m_lastModDp.UCPTlength.get()||2;if(this.m_lastModDp.UCPTstartBit.get()){a+=1}return this.m_lastModDp.UCPTstartAddress.get()+a},addDp:function(a){if(a.UCPTstartAddress.get()>this.m_lastModDp.UCPTstartAddress.get()){this.m_lastModDp=a}}},"private":{m_len:{UNVT_float:2,UNVT_double_float:4,UNVT_unsigned_quad:2,UNVT_signed_quad:2,UNVT_unsigned_long:1,UNVT_signed_long:1,UNVT_unsigned_short:1,UNVT_signed_short:1,UNVT_boolean:1,SNVT_count:1,SNVT_count_inc:1,SNVT_str_asc:16}}});elon.UIConfigurator=elon.Class({instantiator:"singleton",constructor:function(){this.m_webDpPrefix="#Web/global/";this.m_sso=elon.elon.getTopLevelSSO();this.m_cookie2webDp();this.subscribe("useCookies",this.m_toggleCookieUsage)},"public":{get:function(a){return this.m_sso.getItem({type:this.m_dp[a].type,Item:this.m_webDpPrefix+a})},subscribe:function(a,b){this.m_sso.subscribe({Item:this.m_webDpPrefix+a,type:this.m_dp[a].type,callback:b})},getValue:function(a){return this.get(a).value.get()}},"private":{"callback:m_toggleCookieUsage":function(c){var b=c.value.get();for(var a in this.m_dp){if(this.m_dp[a].permanent!=false){this.m_sso[b?"subscribe":"unsubscribe"]({Item:this.m_webDpPrefix+a,type:this.m_dp[a].type,callback:this.m_webDp2cookie})}if(!b){this.m_del(this.m_webDpPrefix+a)}}},m_cookie2webDp:function(){for(var key in this.m_dp){this.m_del("NVV/WEB/WEB/"+key);var cookieVal=this.m_get(key);var item=this.m_dp[key];var initialized=false;if(cookieVal!=null&&item.permanent!=false){try{if(cookieVal.indexOf("www.w3.org/2001/XMLSchema-instance")>-1){this.m_sso.convertFromXml({type:item.type,Item:this.m_webDpPrefix+key,xml:cookieVal})}else{window.eval("elon.UIConfigurator.m_tmpEvalObj="+cookieVal);if(elon.UIConfigurator.m_tmpEvalObj){elon.UIConfigurator.m_tmpEvalObj.UCPTname=this.m_webDpPrefix+key;this.m_sso.convertFromSimple({type:item.type,Item:elon.UIConfigurator.m_tmpEvalObj})}}initialized=true}catch(e){}}if(key=="debugWebUi"){item.defaultVal=elon.debugWebUi}else{if(key=="soapTimeout"){item.defaultVal=elon.debugWebUi?20:120}}if(!initialized&&item.defaultVal!=null){this.m_sso.getItem({type:item.type,Item:this.m_webDpPrefix+key}).value.set(item.defaultVal)}}},m_get:function(a){var d=EchelonTop.window.document;if(d.cookie.length>0){var c=d.cookie.indexOf(a+"=");if(c!=-1){c+=a.length+1;var b=d.cookie.indexOf(";",c);if(b==-1){b=d.cookie.length}return unescape(d.cookie.substring(c,b))}}return null},m_set:function(b,c,a){var d=new Date();d.setTime(d.getTime()+(a*24*3600*1000));EchelonTop.window.document.cookie=b+"="+escape(c)+((a==null)?"":"; expires="+d.toGMTString())},m_del:function(a){if(this.m_get(a)){EchelonTop.window.document.cookie=a+"=; expires=Thu, 01-Jan-70 00:00:01 GMT"}},"callback:m_webDp2cookie":function(b){var c=this.m_sso.convertToSimple({Item:b,callback:function(){}});delete c.UCPTname;var a=elon.util.serialize(c);if(a){this.m_set(b.UCPTname.get(),a,10000)}},m_dp:{debugWebUi:{permanent:true,type:"BoolItem"},disablePoll:{type:"BoolItem",defaultVal:false},showSyncProgress:{type:"BoolItem",defaultVal:false},GlobalSettings_Communication:{type:"GlobalSettings_Communication"},modAddress:{type:"ModAddressCfg_Data"},msgVisibility_debug:{defaultVal:false,type:"BoolItem"},msgVisibility_error:{defaultVal:true,type:"BoolItem"},msgVisibility_info:{defaultVal:true,type:"BoolItem"},msgVisibility_warning:{defaultVal:true,type:"BoolItem"},pollRate:{defaultVal:1,type:"IntItem"},schedulerMonths:{defaultVal:12,type:"IntItem"},schedulerSync:{defaultVal:true,type:"BoolItem"},soapTimeout:{type:"IntItem"},srvType:{defaultVal:"AUTO",type:"StringItem"},tree:{type:"DpTree_Cfg",permanent:true},useCookies:{defaultVal:false,type:"BoolItem"}}}});elon.PollCollector=elon.Class({instantiator:"singleton","public":{poll:function(c){var h=elon.UIConfigurator().get("GlobalSettings_Communication");var e=(h.maxAgeMode.get()=="MANUAL")?h.maxAge.get():null;var d=c.maxAge;var b={type:"Dp_Data",Item:c.dpName,callback:c.callback,UCPTmaxAge:c.maxAge,maxAge:c.pollInterval};if(c.id){b.id=c.id}var g="#Web/global/pollDP-"+c.sso.getUrl()+c.dpName;var i=c.sso.getItem({type:"Dp_Data",Item:g});var f=(d!=null&&(i.UCPTmaxAge.get()==null||d<i.UCPTmaxAge.get()));if(c.lonFormat||f){if(c.lonFormat){var a=elon.util.getUCPTvalueObj(i,c.lonFormat);if(!a){if(i.UCPTvalue.length==0){a=i.UCPTvalue.push();a.LonFormat.set("");a.set("");a=i.UCPTvalue.push();a.LonFormat.set("UCPTvalueDef");a.set("")}a=i.UCPTvalue.push();a.LonFormat.set(c.lonFormat);a.set("");b.forceFetch=true}}if(f){i.UCPTmaxAge.set(d);b.forceFetch=true}}b.pollItem=c.sso.getItem({type:"Dp_Data",Item:c.dpName,unmanaged:true,noSubmit:true});b.pollItem.y_proxy_copy(i);b.UCPTmaxAge=b.pollItem.UCPTmaxAge.get();if(b.UCPTmaxAge==null){b.pollItem.UCPTmaxAge.set(e)}if(!this.m_queue){this.m_queue={};elon.util.fireQuickCallback(this.m_startPolling)}if(!this.m_queue[g]){this.m_queue[g]={callbacks:[],sso:c.sso}}this.m_queue[g].callbacks.push(c.callback);this.m_queue[g].reqObj=b;if(b.forceFetch){this.m_queue[g].forceFetch=true}}},"private":{"callback:m_startPolling":function(){for(var b in this.m_queue){var c=this.m_queue[b].reqObj;c.forceFetch=this.m_queue[b].forceFetch;for(var a=0;a<this.m_queue[b].callbacks.length;a++){c.callback=this.m_queue[b].callbacks[a];this.m_queue[b].sso.poll(c);c.forceFetch=false}}this.m_queue=null}}});Echelon.InternalSyncer=elon.Class({instantiator:"perServer",constructor:["m_url"],closure:function(a){if(elon.filter.boolStrToBool(a.value.get())){elon.elon.getTopLevelSSO().addPostSubmitCallback(this.m_submitCB)}else{elon.elon.getTopLevelSSO().cancelPostSubmitCallback(this.m_submitCB)}},"private":{"callback:m_submitCB":function(){var c=elon.ReadyManager.getInstance();var b=["Device","Device_NetworkInterface","Device_RNI","Device_Router"];for(var a=0;a<b.length;a++){elon.elon.getTopLevelSSO().Get({xSelect:'//Item[@xsi:type="LON_'+b[a]+'_Cfg"][UCPTlocal="1"]',callback:c.createSimpleCB(b[a]),id:"volatile",unmanaged:true,url:this.m_url})}c.readyCB(b,this.m_listCB)},"callback:m_listCB":function(d){var f=[];var k=elon.elon.getTopLevelSSO();for(var b in d){if(d[b]){for(var a=0;a<d[b].Item.length;a++){var g=d[b].Item[a];if(g.UCPTname.get().match(/^[^\/]+\/#/)){continue}var e="SyncSetRecursive";var h=k.getItem({type:"LON_Network_Command_Invoke",Item:g.UCPTname.get(),unmanaged:true,"volatile":true,url:this.m_url});h.Command.set("Syncronize");h.UCPTannotation.set('allowRequest="false";action="'+e+'";sync="restart"');f.push(h)}}}if(f.length){k.InvokeCmd({Item:f,callback:function(){},url:this.m_url})}else{elon.elon.setErrMsg("Initiating initial sync failed")}}}});elon.provide("Utilities",document);