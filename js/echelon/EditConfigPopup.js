Echelon.StandardPopup=elon.Class({base:{m_complexView:elon.ComplexView},constructor:function(e){e.elon_disable_range="frame";this.m_complexView(e);this.m_popObj=elon.Popup.getExistingInstance(e.domObj.ownerDocument);this.m_popObj.hide();var m=e.domObj.appendChild(e.domObj.ownerDocument.createElement("TABLE"));e.domObj.style.paddingBottom="5px";m.cellSpacing=1;m.cellPadding=1;m.style.border="0px";m.style.width=(e.tableWidth&&(elon.util.addPx(e.tableWidth)))||"100%";m.style.height="100%";m.style.verticalAlign="top";var g=m.createTHead();var j=g.insertRow(g.rows.length);j.style.height="65px";j.style.margin="auto";this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.paddingLeft="10px";this.m_currentCell.className="PopupTitle";this.m_currentCell.style.whiteSpace="nowrap";this.f_titleCell=this.m_currentCell;if(e.controlCell){this.f_controlCell=j.insertCell(j.cells.length);this.f_titleCell.colSpan=1;this.f_titleCell.style.paddingRight="10px"}var d=this.m_currentCell.appendChild(e.domObj.ownerDocument.createElement("IMG"));d.src=e.elon_symbol;d.style.height=d.style.width="60px";d.style.border="0px";d.style.verticalAlign="middle";this.m_title=this.m_currentCell.appendChild(e.domObj.ownerDocument.createTextNode(" "+(e.elon_title||(e.elon_nls_title?this.translate(e.elon_nls_title):this.domObj.ownerDocument.title))));j=g.insertRow(g.rows.length);this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.height="14px";this.m_currentCell.className="TitleBar";j=g.insertRow(g.rows.length);j.style.height="25px";j.style.margin="auto";this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.whiteSpace="nowrap";this.m_currentCell.style.paddingLeft="5px";if(!e.elon_no_msg_bar){elon.viewMessageBarObject({domObj:this.m_currentCell,elon_aux_msg_bar:true})}var c=m.appendChild(e.domObj.ownerDocument.createElement("TBODY"));j=c.insertRow(c.rows.length);j.style.height="auto";this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.className="PopupText";this.m_currentCell.style.verticalAlign="top";this.f_tableParent=this.m_currentCell;var l=m.createTFoot();j=l.insertRow(l.rows.length);this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.height="5px";j=l.insertRow(l.rows.length);this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.height="5px";this.m_currentCell.className="TitleBar";j=l.insertRow(l.rows.length);this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.height="5px";j=l.insertRow(l.rows.length);j.style.height="25px";this.m_currentCell=j.insertCell(j.cells.length);this.m_currentCell.colSpan=2;this.m_currentCell.style.whiteSpace="nowrap";for(var b in e.preOkButtons){var a=e.preOkButtons[b];e.preOkButtons[b]=this.f_button(null,this.translate(b));e.preOkButtons[b].addEvent("click",a)}if(e.elon_yes_no){e.cancelButtonLabel="NO";e.okButtonLabel="YES"}if(e.elon_ok_button_label){e.okButtonLabel=e.elon_ok_button_label}if(e.elon_cancel_button_label){e.cancelButtonLabel=e.elon_cancel_button_label}var k=(e.cancelButton||e.cancelCB||e.cancelButtonLabel);this.m_popOkButton=this.f_button("ok",k?this.translate(e.okButtonLabel||"OK"):this.translate(e.okButtonLabel||"CLOSE"));this.m_popOkButton.domObj.tabIndex=2;if(e.elon_disable_close){this.m_popOkButton.setDisabled(true)}if(e.elon_popup_remote){this.f_sso.subscribe({type:"PopupRemote_Data",Item:e.elon_popup_remote,noInitialCallback:true,callback:this.m_remoteControl})}this.m_popOkButton.addEvent("click",this.f_okCb);if(k){this.m_popCancelButton=this.f_button("cancel",this.translate(e.cancelButtonLabel||"CANCEL"));this.m_popCancelButton.domObj.tabIndex=3}if(k||e.closeCB){var h=this.m_PopCancelCB();if(this.m_popCancelButton){this.m_popCancelButton.addEvent("click",h)}elon.Popup.getExistingInstance(e.domObj.ownerDocument).closeCb=h}for(var b in e.postCancelButtons){var a=e.postCancelButtons[b];e.postCancelButtons[b]=this.f_button(null,this.translate(b));elon.util.addClassName(b,e.postCancelButtons[b].domObj);e.postCancelButtons[b].addEvent("click",a)}this.m_popObj.adjust();if(e.elon_treepopup){this.m_resize=this.m_popObj.adjust}else{var f=elon.AutoScrollDiv({domObj:this.f_tableParent,preResizeCB:this.m_popObj.adjust});this.f_tableParent=f.div;this.m_resize=f.resizeCB}elon.UtilObject.getInstance().fireQuickCallback(this.m_finalize,this);this.m_managedCopies=[]},"protected":{"callback:f_resize":function(a,b){this.m_resize(a,b);if(!this.m_wasResizedAlready){if(!this.m_finalized){return this.m_toBeShown=true}this.m_wasResizedAlready=true;this.m_popObj.show()}},"callback:f_delayedResize":function(){elon.UtilObject.getInstance().fireQuickCallback(this.f_resize,this)},"callback:f_scrolling":function(){try{var b=this.argObj.domObj.ownerDocument}catch(a){return false}return(b.body.scrollWidth>b.body.clientWidth||b.body.scrollHeight>elon.dom.getBodyClientHeight(b))},f_height:function(){return elon.dom.getBodyClientHeight(this.argObj.domObj.ownerDocument)},f_width:function(){return this.argObj.domObj.ownerDocument.body.clientWidth},changeTitle:function(a){this.m_title.nodeValue=a},f_button:function(c,e){var d={parentDomObj:this.m_currentCell};if(this.argObj[c+"WebDpName"]){d.elon_webdpname=this.argObj[c+"WebDpName"];d.elon_no_initial_callback=true}var a=elon.viewButtonObject.getInstance(d);a.setLabel(e);a.domObj.className="ControlButton";a.domObj.style.textAlign="center";return a},"callback:f_focusOk":function(){elon.UtilObject.getInstance().fireQuickCallback(function(){if(!this.argObj.elon_disable_close){try{this.m_popOkButton.domObj.focus()}catch(a){}}},this)},"callback:f_focusCancel":function(){elon.UtilObject.getInstance().fireQuickCallback(function(){this.m_popCancelButton.domObj.focus()})},f_preOkField:function(a){a.addEvent("keydown",this.m_focusOk)},f_mainField:function(a){this.f_preOkField(a);this.f_startField(a)},f_getCopy:function(c,b,a){this.m_createCopy(c,b,null,a)},f_getRemocalCopy:function(c,b,d,a){this.m_createCopy(c,b,d,a)},f_subscribeCopy:function(c,b,d,a){this.m_createCopy(c,b,null,a);this.f_sso.subscribe({type:c,Item:b,callback:d,id:this})},f_createCopies:function(a,e){var f=elon.ReadyManager.getInstance();var b=[];for(var d in a){var c=a[d][0];var g=a[d][1];var j=a[d][2];var h=a[d][3];if(j){this.m_createCopy(g,j,this.m_CopyHandler(c,f,h));b.push(c)}}f.readyCB(b,e)},"callback:f_okCb":function(){this.m_acceptChanges();if(this.argObj.okCB){this.argObj.okCB()}else{if(this.argObj.closeCB){this.argObj.closeCB()}else{this.f_close()}}},"callback:f_disableOk":function(){this.m_popOkButton.setDisabled(true)},"callback:f_enableOk":function(){this.m_popOkButton.setDisabled(false)},"callback:f_close":function(){this.f_enableUI();elon.Popup.close(this.doc)},"callback:f_addOkCB":function(a){this.m_popOkButton.addEvent("click",a)}},"private":{m_finalize:function(){this.m_finalized=true;if(this.m_toBeShown){delete this.m_toBeShown;this.f_resize()}},m_createCopy:function(d,b,e,a){var c={type:d,Item:b,copy:{Item:this.webDpName("this",a||("EditConfigPopup_"+d+this.m_managedCopies.length))}};if(e){c.callback=e}else{c.noPreprocessing=true}this.f_sso.copy(c);this.m_managedCopies.push(c)},"nest:m_CopyHandler":elon.Class({constructor:["m_varName","m_readyManager","m_callback"],closure:function(a){this.parent[this.m_varName]=a;this.m_readyManager.ready(this.m_varName);if(this.m_callback){this.parent.f_sso.subscribe({type:a.r_proxy_type,Item:a.UCPTname.get(),callback:this.m_callback,noInitialCallback:true})}}}),m_acceptChanges:function(){for(var a=0;a<this.m_managedCopies.length;a++){var b=this.m_managedCopies[a];this.f_sso.copy({type:b.type,Item:b.copy.Item,copy:{Item:b.Item}});this.f_sso.unsubscribe({type:b.type,Item:b.copy.Item,callback:this.m_callback})}},"callback:m_focusOk":function(a){if((a.keyCode==9)||(a.keyCode==13)){try{this.f_focusOk()}catch(b){}}},"callback:m_remoteControl":function(a){if(a.close.get()){this.f_close()}},"nest:m_PopCancelCB":elon.Class({closure:function(){if(this.parent.argObj.elon_cancel_type){this.parent.f_sso.getItem({type:this.parent.argObj.elon_cancel_type,Item:this.parent.argObj.elon_name}).cancelled.set(true,this)}if(this.parent.argObj.cancelCB){this.parent.argObj.cancelCB()}if(this.parent.argObj.closeCB){this.parent.argObj.closeCB()}else{elon.Popup.close(this.parent.doc)}}})}});Echelon.EditConfigPopup=new elon.Class.Backport(Echelon.StandardPopup);